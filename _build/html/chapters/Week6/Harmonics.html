

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Filtering in the Time Domain: Part II &#8212; Climate and Geophysical Data Analysis</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/Week6/Harmonics';</script>
    <link rel="canonical" href="https://kls2177.github.io/Climate-and-Geophysical-Data-Analysis/chapters/index.html/chapters/Week6/Harmonics.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/gistemp.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/gistemp.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/intro.html">Introduction</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/aboutthisbook.html">About this book</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/howtousethisbook.html">How to use this book</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week1a/whatarestatsgoodfor.html">What are statistics good for?</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week1a/goodpractice.html">Statistics is the grammar of science…</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week1a/pitfalls.html">Lies, damned lies and statistics…</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/kls2177/Climate-and-Geophysical-Data-Analysis/master?urlpath=tree/chapters/Week6/Harmonics.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chapters/Week6/Harmonics.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Filtering in the Time Domain: Part II</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-harmonics">Introduction to Harmonics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#review-of-the-sine-function">Review of the Sine Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fourier-series">Fourier Series</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-this-framework-we-can-write-a-time-series-y-t-as">Using this framework, <em>we can write a time series, <span class="math notranslate nohighlight">\(y(t)\)</span></em>, as</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nyquist-wavenumber-frequency">Nyquist Wavenumber/Frequency</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#method-4-filtering-the-seasonal-cycle-using-harmonics">Method 4: Filtering the Seasonal Cycle using Harmonics</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="filtering-in-the-time-domain-part-ii">
<h1>Filtering in the Time Domain: Part II<a class="headerlink" href="#filtering-in-the-time-domain-part-ii" title="Permalink to this headline">#</a></h1>
<p>In this section, we will begin exploring how time series can be decomposed into a linear combination of sine and cosine funtions. This concept is critically important to time series analysis and will allow us to evaluate time scales of variability in the <em>frequency</em> domain.</p>
<section id="introduction-to-harmonics">
<h2>Introduction to Harmonics<a class="headerlink" href="#introduction-to-harmonics" title="Permalink to this headline">#</a></h2>
<p>For oscillatory time series, like those with a distinct seasonal cycle, we can fit <strong>harmonics</strong>, aka, sine and cosine functions (see <a class="reference internal" href="#harmonics"><span class="std std-ref">Figure 20</span></a>), to the data in order to remove these oscillations.</p>
<figure class="align-default" id="harmonics">
<a class="reference internal image-reference" href="../../_images/sine_cosine.png"><img alt="../../_images/sine_cosine.png" src="../../_images/sine_cosine.png" style="width: 786.4000000000001px; height: 316.0px;" /></a>
<figcaption>
<p><span class="caption-text">Sine (red curve) and cosine (blue curve) functions.</span><a class="headerlink" href="#harmonics" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<section id="review-of-the-sine-function">
<h3>Review of the Sine Function<a class="headerlink" href="#review-of-the-sine-function" title="Permalink to this headline">#</a></h3>
<p>A sine function can be written as,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
y(t) &amp; = A \text{sin}(2\pi ft + \phi)\\
&amp; = A \text{sin}(\omega t + \phi)
\end{align}
\end{split}\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude, the deviation of the curve from zero</p></li>
<li><p><span class="math notranslate nohighlight">\(f\)</span> is the frequency in units of the number of oscillations that occur each time step</p></li>
<li><p><span class="math notranslate nohighlight">\(\omega\)</span> = 2<span class="math notranslate nohighlight">\(\pi f\)</span> is the angular frequency, or the frequency in units of radians per time step</p></li>
<li><p><span class="math notranslate nohighlight">\(\phi\)</span> is the phase (in radians), or the shift.</p></li>
</ul>
<p><em>As a reminder:</em></p>
<ul class="simple">
<li><p>frequency, <span class="math notranslate nohighlight">\(f\)</span>: number of oscillations per time step</p></li>
<li><p>period, <span class="math notranslate nohighlight">\(T\)</span>: number of time steps per oscillation, <span class="math notranslate nohighlight">\(\frac{1}{f}\)</span></p></li>
<li><p>wavenumber, <span class="math notranslate nohighlight">\(k\)</span> (an integer): number of oscillations that fit inside the domain, <span class="math notranslate nohighlight">\(k\)</span> = <span class="math notranslate nohighlight">\(fT\)</span>.</p></li>
</ul>
</section>
<section id="fourier-series">
<h3>Fourier Series<a class="headerlink" href="#fourier-series" title="Permalink to this headline">#</a></h3>
<p><strong>Fourier Series</strong> is a way of representing a time series as a summation of contributions from harmonic functions, each with a unique temporal scale. These harmonic functions form a <a class="reference external" href="https://mathworld.wolfram.com/VectorBasis.html"><em>basis</em></a>.</p>
<p>This is analogous to regression, where you try to describe one variable as a combination of others. But, in the case of harmonic analysis, the functions to be fit (i.e., the predictors) are sines and cosines:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\text{sin}(2\pi k \frac{t}{T})\\
\text{cos}(2\pi k \frac{t}{T})    
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> is an integer from 1 to <span class="math notranslate nohighlight">\(N\)</span>/2 (and <span class="math notranslate nohighlight">\(N\)</span> is the number of values you have in the time series), and is often called the wavenumber.</p>
<p>Recall that in this case, <span class="math notranslate nohighlight">\(k/T = f\)</span>.</p>
<section id="using-this-framework-we-can-write-a-time-series-y-t-as">
<h4>Using this framework, <em>we can write a time series, <span class="math notranslate nohighlight">\(y(t)\)</span></em>, as<a class="headerlink" href="#using-this-framework-we-can-write-a-time-series-y-t-as" title="Permalink to this headline">#</a></h4>
<div class="math notranslate nohighlight">
\[
y(t) = A_0 + \sum_{k=1}^{N/2} A_k\text{cos}(2\pi k \frac{t}{T}) +  \sum_{k=1}^{N/2} B_k\text{sin}(2\pi k \frac{t}{T})
\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y\)</span> is resolved on the time interval from 0 <span class="math notranslate nohighlight">\(\leq\)</span> <span class="math notranslate nohighlight">\(t\)</span> <span class="math notranslate nohighlight">\(\leq\)</span> <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>the length of the time series is <span class="math notranslate nohighlight">\(N\)</span> + 1 (note that <span class="math notranslate nohighlight">\(N\)</span> needs to be even so that the highest wavenumber is an integer)</p></li>
<li><p><span class="math notranslate nohighlight">\(A_k\)</span> and <span class="math notranslate nohighlight">\(B_k\)</span> are the regression coefficients for each predictor each predictor is a harmonic function with frequency 2<span class="math notranslate nohighlight">\(\pi k/T\)</span> and thus fits into the interval from <span class="math notranslate nohighlight">\(t_1\)</span> = 0 to <span class="math notranslate nohighlight">\(t_N\)</span>+1 = <span class="math notranslate nohighlight">\(T\)</span> an integer <span class="math notranslate nohighlight">\(k\)</span> number of times</p></li>
<li><p>if <span class="math notranslate nohighlight">\(k\)</span> = 1, the function has frequency 2<span class="math notranslate nohighlight">\(\pi\)</span> radians in the full length of the data. This is the lowest resolved frequency.</p></li>
<li><p>if <span class="math notranslate nohighlight">\(k\)</span> = <span class="math notranslate nohighlight">\(N\)</span>/2, the function has frequency 2<span class="math notranslate nohighlight">\(\pi\)</span> radians in 2 time steps (and <span class="math notranslate nohighlight">\(B_k\)</span> is zero). This is the highest possible wavenumber/frequency that can be resolved using Fourier series, called the <em>Nyquist frequency</em>.</p></li>
</ul>
<p>There are many animations of how fourier series can be used to create time series that look very different from the individual sine and cosine componenents on youtube: here is <a class="reference external" href="https://www.youtube.com/watch?v=LznjC4Lo7lE&amp;feature=emb_logo">one example</a>.</p>
<p>Let’s take a look at plotting some harmonic components using the above equation for <span class="math notranslate nohighlight">\(y(t)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import packages</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>We will start by picking a period, <span class="math notranslate nohighlight">\(T\)</span>, and a sampling rate, <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># harmonic parameters (period and sampling rate)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="n">sampling_rate</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="c1"># define time dimension based on period and sampling rate</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">T</span><span class="o">+</span><span class="n">sampling_rate</span><span class="p">,</span><span class="n">sampling_rate</span><span class="p">)</span>

<span class="c1"># length of time series</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>Note that the period, <span class="math notranslate nohighlight">\(T\)</span>, divided by <span class="math notranslate nohighlight">\(N\)</span> gives the sampling rate. Now, we can plot different harmonic components.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># colours for plotting</span>
<span class="n">CLRs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;limegreen&#39;</span><span class="p">,</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span><span class="s1">&#39;crimson&#39;</span><span class="p">]</span>

<span class="c1"># initialize figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.75</span><span class="p">,</span><span class="mf">1.75</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Harmonic Components for N = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># counting index for changing the plotting colour</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># loop over three values for wavenumber, k</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">):</span>
    
    <span class="c1"># define sine and cosine components of y(t)</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>

    <span class="c1"># plot harmonic components</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="s1">&#39;x--&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">CLRs</span><span class="p">[</span><span class="n">count</span><span class="p">],</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;k=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="s1">&#39;o--&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">CLRs</span><span class="p">[</span><span class="n">count</span><span class="p">],</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>

    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x111d6a1d0&gt;
</pre></div>
</div>
<img alt="../../_images/9faa2b9b0b22e645c61c1e0c3fef75c4bd59104659a06fcd3fb8baced294c24e.png" src="../../_images/9faa2b9b0b22e645c61c1e0c3fef75c4bd59104659a06fcd3fb8baced294c24e.png" />
</div>
</div>
<p>What happens when <span class="math notranslate nohighlight">\(k\)</span> = <span class="math notranslate nohighlight">\(N\)</span>/2, the Nyquist frequency? The sine wave component becomes zero at all times.</p>
</section>
</section>
<section id="nyquist-wavenumber-frequency">
<h3>Nyquist Wavenumber/Frequency<a class="headerlink" href="#nyquist-wavenumber-frequency" title="Permalink to this headline">#</a></h3>
<p>The <em>Nyquist wavenumber/frequency</em> (<span class="math notranslate nohighlight">\(k\)</span> = <span class="math notranslate nohighlight">\(N\)</span>/2) is the highest frequency that can be resolved in your data using Fourier series. Why is this? Why not <span class="math notranslate nohighlight">\(k\)</span> = <span class="math notranslate nohighlight">\(N\)</span>?</p>
<p>As stated above, if <span class="math notranslate nohighlight">\(k\)</span> = <span class="math notranslate nohighlight">\(N\)</span>/2, the function has frequency 2<span class="math notranslate nohighlight">\(\pi\)</span> radians in 2 time steps. If <span class="math notranslate nohighlight">\(k\)</span> = <span class="math notranslate nohighlight">\(N\)</span>, this would imply that the function has a frequency of 2<span class="math notranslate nohighlight">\(\pi\)</span> radians in 1 time step. But, Hhow can we detect a complete cycle in a single time step? We can’t. In other words, we cannot resolve frequencies that are higher than the Nyquist frequency.</p>
<p>Let’s take a look what this means using python. First, let’s define our harmonic parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># harmonic parameters (period and sampling rate)</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">10.</span> 
<span class="n">sampling_rate</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="c1"># define time dimension based on period and sampling rate</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">T</span><span class="o">+</span><span class="n">sampling_rate</span><span class="p">,</span><span class="n">sampling_rate</span><span class="p">)</span>

<span class="c1"># length of time series</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The wavenumber corresponding to the Nyquist frequency is&quot;</span><span class="p">,</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># Nyquist wavenumber: k = N/2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This means that the Nyquist frequency is&quot;</span><span class="p">,</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">T</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># using f = k/T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The wavenumber corresponding to the Nyquist frequency is 500.0
This means that the Nyquist frequency is 50.0 
</pre></div>
</div>
</div>
</div>
<p>Below, we will examine how the sampling rate affects the resolved frequencies. We will assume that we have a “true” cosine wave and one that we are trying to resolve using a lower-frequency sampling rate. As some point the sampling rate is not sufficient to resolve the frequency/wavenumber of the cosine wave, demonstrating the threshold Nyquist frequency.</p>
<p>Let’s define a new time dimension with a lower-frequency sampling rate:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># low frequency t used to demonstrate how sampling rate effects our ability to detect all frequencies</span>
<span class="n">sampling_rate_low</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># define time dimension based on period and sampling rate</span>
<span class="n">tl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="n">sampling_rate_low</span><span class="p">,</span><span class="n">sampling_rate_low</span><span class="p">)</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The wavenumber corresponding to the Nyquist frequecy for the low-frequency sampling rate is&quot;</span><span class="p">,(</span><span class="nb">len</span><span class="p">(</span><span class="n">tl</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This means that the Nyquist frequency for the low-frequency sampling rate is&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tl</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">T</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The wavenumber corresponding to the Nyquist frequecy for the low-frequency sampling rate is 5.0
This means that the Nyquist frequency for the low-frequency sampling rate is 0.5 
</pre></div>
</div>
</div>
</div>
<p>Notice how the Nyquist wavenumber/frequency changes. This means that we will only be able to detect the correct frequency of the cosine wave up to wavenumber= 5.0 or frequency = 0.5 for the given sampling rate.</p>
<p>Use the “Live Code/Launch Thebe” button to see what happens when we change <span class="math notranslate nohighlight">\(k\)</span> below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># see what happends when you change wavenumber to the following values (1, 3, 5, 7, 10)</span>

<span class="c1"># initialize figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.3</span><span class="p">,</span><span class="mf">1.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Nyquist cutoff: 5 total waves, 1 per 2 time steps&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="c1"># define cosine wave using high-frequency t: this will be our &quot;true&quot; cosine wave</span>
<span class="n">yh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>

<span class="c1"># plot true cosine wave</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yh</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;True Cosine Wave&#39;</span><span class="p">)</span>

<span class="c1">#define harmonics using low-frequency t</span>
<span class="n">yl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">tl</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tl</span><span class="p">,</span><span class="n">yl</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">markersize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tl</span><span class="p">,</span><span class="n">yl</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sampled Cosine Wave&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/bfd19b17c0b4dfe130490e338e24425da4f222121eec7045bc65edd6fe1ca7ee.png" src="../../_images/bfd19b17c0b4dfe130490e338e24425da4f222121eec7045bc65edd6fe1ca7ee.png" />
</div>
</div>
<p>What happens when <span class="math notranslate nohighlight">\(k\)</span> becomes larger than the Nyquist wavenumber, 5? In other words, what happens if we have higher frequencies in our data? In this case, they will get <em>aliased</em> onto lower frequencies (e.g. when <span class="math notranslate nohighlight">\(k\)</span> = 7 in the above example). This can be a problem when there is a large amount of variance in frequencies higher than the Nyquist frequency. We will revisit the concept of aliasing in the next section.</p>
<p>Note that the Nyquist frequency is completely dependent on your <em>sampling rate</em> (temporal resolution of your data), <strong>NOT</strong> the total amount of data you have. The smaller the time step, the higher the Nyquist frequency.</p>
</section>
</section>
<section id="method-4-filtering-the-seasonal-cycle-using-harmonics">
<h2>Method 4: Filtering the Seasonal Cycle using Harmonics<a class="headerlink" href="#method-4-filtering-the-seasonal-cycle-using-harmonics" title="Permalink to this headline">#</a></h2>
<p>Now, that we have reviewed sine and cosine waves and fourier series, we will explore how we can use harmonics to describe time series with oscillations and take advantage of this to filter such time series.</p>
<p>In this section, we will make sure of a package called <a class="reference external" href="https://www.esrl.noaa.gov/gmd/ccgg/mbl/crvfit/crvfit.html"><code class="docutils literal notranslate"><span class="pre">ccgfilt()</span></code></a> to fit harmonic functions to our Arctic SIE time series. You can download a copy of the function <a class="reference external" href="https://github.com/kls2177/ccia_files/blob/master/ccgfilt3.py?raw=true">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import packages</span>
<span class="kn">import</span> <span class="nn">ccgfilt3</span> <span class="k">as</span> <span class="nn">ccgfilt</span>
<span class="kn">import</span> <span class="nn">pickle</span> <span class="k">as</span> <span class="nn">pickle</span>
</pre></div>
</div>
</div>
</div>
<p>Read in the Arctic SIE data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in data</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;SIE_Total.pickle&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="n">sie</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;iso8859&#39;</span><span class="p">)</span>
    
<span class="c1"># convert sie to time series </span>
<span class="c1"># (I&#39;m using np.ravel but you can also use np.reshape)</span>
<span class="n">sie_ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">sie</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This function needs the time dimension in decimal years.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert time to &quot;decimal year&quot;</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">sie_ts</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">/</span><span class="mf">365.0</span>
</pre></div>
</div>
</div>
</div>
<p>Here, we will use the <code class="docutils literal notranslate"><span class="pre">ccgfilt()</span></code> function to fit 5 harmonic functions. You can use the “Live Code/Launch Thebe” button to change the number of harmonics and see what happens.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create ccgfilt instance</span>
<span class="n">filt</span> <span class="o">=</span> <span class="n">ccgfilt</span><span class="o">.</span><span class="n">ccgFilter</span><span class="p">(</span><span class="n">dtime</span><span class="p">,</span><span class="n">sie_ts</span><span class="o">/</span><span class="mf">1e12</span><span class="p">,</span> <span class="n">sampleinterval</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">numpolyterms</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">numharmonics</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">timezero</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To extract the harmonic component, we can do the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract the harmonic component of the fit, i.e. the seasonal cycle</span>
<span class="n">sie_season</span> <span class="o">=</span> <span class="n">filt</span><span class="o">.</span><span class="n">getHarmonicValue</span><span class="p">(</span><span class="n">dtime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>What does this seasonal cycle look like?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot seasonal cycle</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sie_season</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="o">*</span><span class="mi">365</span><span class="p">])</span> <span class="c1"># plot one year of harmonic time series to show seasonal cycle</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="mi">365</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Days&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sea Ice Extent (10$^6$ km$^2$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SIE Anomaly from a Year-2000 GCM Control Integration (first 50 years only)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/346adeeedcd797a2de36bc82456dab1ccc216e4034f43942bf72506a63c04db4.png" src="../../_images/346adeeedcd797a2de36bc82456dab1ccc216e4034f43942bf72506a63c04db4.png" />
</div>
</div>
<p>We can now simply substract this harmonic fit from the original time series to filter out the seasonal cycle.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove the seasonal cycle from original time series</span>
<span class="n">sie_deseason5</span> <span class="o">=</span> <span class="n">sie_ts</span><span class="o">/</span><span class="mf">1e12</span> <span class="o">-</span> <span class="n">sie_season</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot to show that the seasonal cycle has been removed</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sie_deseason5</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">50</span><span class="o">*</span><span class="mi">365</span><span class="p">])</span> <span class="c1">#this data consists of 400 years of daily data, but here I am just plotting 50 years</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="o">*</span><span class="mi">365</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Days&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sea Ice Extent (10$^6$ km$^2$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SIE with Seasonal Cycle Removed (first 5 harmonics) from GCM Pre-Industrial Integration (first 50 years only)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9d50dfb3cd679074b01e21b5ff8eb41660b7b365df52bab2312ab4e22285e7ef.png" src="../../_images/9d50dfb3cd679074b01e21b5ff8eb41660b7b365df52bab2312ab4e22285e7ef.png" />
</div>
</div>
<p>Note, that the harmonics are fit to the time series with the long-term mean removed (this is the <code class="docutils literal notranslate"><span class="pre">numpolyterms</span> <span class="pre">=</span> <span class="pre">0</span></code> parameter). Thus, when we subtract the seasonal cycle, we get an anomaly that fluctuates around the long-term mean.</p>
<p>In the next section, we will build on the concept of Fourier series to explore time scales of variability in the <em>frequency</em> domain.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "kls2177/Climate-and-Geophysical-Data-Analysis",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters/Week6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-harmonics">Introduction to Harmonics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#review-of-the-sine-function">Review of the Sine Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fourier-series">Fourier Series</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-this-framework-we-can-write-a-time-series-y-t-as">Using this framework, <em>we can write a time series, <span class="math notranslate nohighlight">\(y(t)\)</span></em>, as</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nyquist-wavenumber-frequency">Nyquist Wavenumber/Frequency</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#method-4-filtering-the-seasonal-cycle-using-harmonics">Method 4: Filtering the Seasonal Cycle using Harmonics</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Karen Smith
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>