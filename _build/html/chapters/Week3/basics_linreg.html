
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction to Linear Regression &#8212; Climate and Geophysical Data Analysis</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://kls2177.github.io/Climate-and-Geophysical-Data-Analysis/chapters/index.html/chapters/Week3/basics_linreg.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Confidence Intervals" href="confidence_intervals.html" />
    <link rel="prev" title="Linear Regression" href="linreg.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://kls2177.github.io/Climate-and-Geophysical-Data-Analysis/chapters/index.html/chapters/Week3/basics_linreg.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Introduction to Linear Regression" />
<meta property="og:description" content="Introduction to Linear Regression  In linear regression, we seek to determine:  the linear relationship between two variables x and y  the robustness of the rel" />
<meta property="og:image"       content="https://kls2177.github.io/Climate-and-Geophysical-Data-Analysis/chapters/index.html/_static/gistemp.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/gistemp.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Climate and Geophysical Data Analysis</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Climate and Geophysical Data Analysis
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week1a/whatarestatsgoodfor.html">
   What are statistics good for?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week1b/descriptivestats.html">
   Descriptive Statistics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week2/hypothesis_testing.html">
   Statistical Hypothesis Testing
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="linreg.html">
   Linear Regression
  </a>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Introduction to Linear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="confidence_intervals.html">
     Confidence Intervals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="goodness.html">
     Goodness of Fit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="assumptions.html">
     Assumptions of Linear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="composites.html">
     Compositing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="filtering.html">
     Filtering or Detrending using Regression
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week4/corr.html">
   Correlation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week5/persistence.html">
   Persistence in Time Series
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week6/filt.html">
   Time Series Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week7/pca.html">
   Patterns in Multivariate Data
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/chapters/Week3/basics_linreg.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/kls2177/Climate-and-Geophysical-Data-Analysis/master?urlpath=tree/chapters/Week3/basics_linreg.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/kls2177/Climate-and-Geophysical-Data-Analysis/blob/master/chapters/Week3/basics_linreg.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-by-example-enso-and-california-precipitation">
   Regression by Example: ENSO and California Precipitation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aside-data-visualization">
     Aside: Data Visualization
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ordinary-least-squares-ols-linear-regression">
   Ordinary Least-Squares (OLS) Linear Regression
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#terminology">
     Terminology
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sum-of-squared-errors">
     Sum of Squared Errors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-best-fit-line-minimizing-q">
     The Best-Fit Line: Minimizing
     <em>
      Q
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-revisited">
   Example Revisited
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="introduction-to-linear-regression">
<h1>Introduction to Linear Regression<a class="headerlink" href="#introduction-to-linear-regression" title="Permalink to this headline">¶</a></h1>
<p>In linear regression, we seek to determine:</p>
<ul class="simple">
<li><p>the linear relationship between two variables <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span></p></li>
<li><p>the robustness of the relationship, i.e., how well the variations in <span class="math notranslate nohighlight">\(x\)</span> explain the variations in $y.</p></li>
</ul>
<p>As we will see, regression is simple, but powerful.</p>
<div class="section" id="regression-by-example-enso-and-california-precipitation">
<h2>Regression by Example: ENSO and California Precipitation<a class="headerlink" href="#regression-by-example-enso-and-california-precipitation" title="Permalink to this headline">¶</a></h2>
<p>I lived in California for a while and California is typically known for it’s warm and <em>dry</em> climate. But, California can experience substantial rainfall in winter and this is related to the phase of the El-Niño Southern Oscillation (ENSO). When there is an El Niño event (anomalously warm sea surface temperatures in the Eastern tropical Pacific), California typically gets more winter rainfall and vice versa when there is a La Niña event.</p>
<p>So, let’s take a look at the relationship between ENSO and California precipitation using 1,100 years of output from a global climate model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load packages</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pickle</span> <span class="k">as</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">st</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span> <span class="c1">#set default font size and weight for plots</span>
</pre></div>
</div>
</div>
</div>
<p>First, we will load in our ENSO and precipitation data from a global climate model. The ENSO index follows the <a class="reference external" href="https://climatedataguide.ucar.edu/climate-data/nino-sst-indices-nino-12-3-34-4-oni-and-tni">NINO3.4 definition</a> and is the November-December-January-February (NDJF) average. You can download the file <a class="reference external" href="https://github.com/kls2177/ccia_files/blob/master/NINO34_NDJF.pickle?raw=true">here</a>.</p>
<p>The precipitation data is averaged over the California region and over the winter months, December-January-February-March. You can download the file <a class="reference external" href="https://github.com/kls2177/ccia_files/blob/master/CA_PRECIP_DJFM.pickle?raw=true">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ENSO Data:</span>
<span class="c1"># unpickle NINO34 (units of degC)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;NINO34_NDJF.pickle&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span> <span class="c1">#.pickle files are a python file type</span>
    <span class="n">nino34</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Precipitation Data:</span>
<span class="c1">#  unpickle CA_PRECIP_DJFM (units of mm/day)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;CA_PRECIP_DJFM.pickle&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span> <span class="c1">#.pickle files are a python file type</span>
    <span class="n">precip_djfm</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s check the shape of our data - we should have 1,100 years of data for each variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check shape of data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nino34</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">precip_djfm</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1100,) (1100,)
</pre></div>
</div>
</div>
</div>
<p>Before we do anything, we should take a quick look at our data. Let’s plot time series plots of the NINO3.4 Index and our DJFM California precipitation. We want to check that our data looks reasonable, that we don’t have any suspicious outliers and that we don’t have any missing data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the precip and NINO34 time series</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">precip_djfm</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;CA DJFM Precipitation&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;mm day$^{-1}$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nino34</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;NDJF NINO3.4 Index&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$^{\circ}$C&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;time&#39;)
</pre></div>
</div>
<img alt="../../_images/basics_linreg_8_1.png" src="../../_images/basics_linreg_8_1.png" />
</div>
</div>
<p>The data looks reasonable, so, let’s start our investigation of the relationship between ENSO and wintertime California precipitation.</p>
<p>Let’s start by plotting a scatter plot. Which is the predictor and which is the predictand?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># scatter plot of CA Precip versus NINO34</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>  <span class="c1"># add zero lines for reference</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>  <span class="c1"># add zero lines for reference</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nino34</span><span class="p">,</span><span class="n">precip_djfm</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># labels, legends, etc.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;NINO3.4 ($^{\circ}$C)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CA Precipitation (mm day$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatter Plot: NINO3.4 vs. CA Precip&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Scatter Plot: NINO3.4 vs. CA Precip&#39;)
</pre></div>
</div>
<img alt="../../_images/basics_linreg_10_1.png" src="../../_images/basics_linreg_10_1.png" />
</div>
</div>
<p>Based on this scatter plot, it looks like California precipitation increases as the NINO3.4 index increases. This suggests that we should be able to construct a linear relationship between these two variables.</p>
<div class="section" id="aside-data-visualization">
<h3>Aside: Data Visualization<a class="headerlink" href="#aside-data-visualization" title="Permalink to this headline">¶</a></h3>
<p>Before, we get into the mathematics of linear regression, let’s take a brief detour into <strong>data visualization</strong>. Effective data visualization is not trivial and it is an extremely important part of science communication. Details in diagrams and plots are often simple but can help to convey meaning. For example, we can make our plot more meaningful by highlighting the El Niño and La Niña events.</p>
<p>SST anomalies in the NINO3.4 region are considered El Niño events if they exceed 0.5<span class="math notranslate nohighlight">\(^\circ\)</span>C and La Niña events if they fall below -0.5<span class="math notranslate nohighlight">\(^\circ\)</span>C. Small magnitude SST anomalies are simply considered neutral ENSO years. Let’s use load a file that identifies these events (<a class="reference external" href="https://github.com/kls2177/ccia_files/blob/master/ENSO_NDJF_years_rev.pickle?raw=true">here</a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># unpickle data indicating strong El Niño/La Niña years</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;ENSO_NDJF_years_rev.pickle&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>   <span class="c1">#another .pickle file</span>
    <span class="n">elnino_yrs</span><span class="p">,</span><span class="n">lanina_yrs</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>

<span class="c1"># create groups of strong El Niño/La Niña years</span>
<span class="n">ElNinoyrs</span> <span class="o">=</span> <span class="n">nino34</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">elnino_yrs</span><span class="p">)]</span>
<span class="n">LaNinayrs</span> <span class="o">=</span> <span class="n">nino34</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">lanina_yrs</span><span class="p">)]</span>

<span class="n">ElNinoP</span> <span class="o">=</span> <span class="n">precip_djfm</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">elnino_yrs</span><span class="p">)]</span>
<span class="n">LaNinaP</span> <span class="o">=</span> <span class="n">precip_djfm</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">lanina_yrs</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># re-plot: detailed version</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nino34</span><span class="p">,</span><span class="n">precip_djfm</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ElNinoyrs</span><span class="p">,</span><span class="n">ElNinoP</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;El Nino&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">LaNinayrs</span><span class="p">,</span><span class="n">LaNinaP</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;La Nina&#39;</span><span class="p">)</span>

<span class="c1"># labels, legends, etc.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;NINO3.4 ($^{\circ}$C)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CA Precipitation (mm day$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatter Plot: NINO3.4 vs. CA Precip&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fc8556016a0&gt;
</pre></div>
</div>
<img alt="../../_images/basics_linreg_13_1.png" src="../../_images/basics_linreg_13_1.png" />
</div>
</div>
<p>Looks nice!</p>
</div>
</div>
<div class="section" id="ordinary-least-squares-ols-linear-regression">
<h2>Ordinary Least-Squares (OLS) Linear Regression<a class="headerlink" href="#ordinary-least-squares-ols-linear-regression" title="Permalink to this headline">¶</a></h2>
<p>How do we find the slope and y-intercept of a line that best fits the relationship between the NINO3.4 index and California precipitation?</p>
<p>Let’s assume <span class="math notranslate nohighlight">\(x(t)\)</span> and <span class="math notranslate nohighlight">\(y(t)\)</span> are time series of size <span class="math notranslate nohighlight">\(N\)</span> (i.e., the data is sampled at <span class="math notranslate nohighlight">\(N\)</span> time steps). The goal of linear regression is to be able to reconstruct or predict <span class="math notranslate nohighlight">\(y(t)\)</span> using <span class="math notranslate nohighlight">\(x(t)\)</span>. Thus, we denote <span class="math notranslate nohighlight">\(x(t)\)</span> as the <strong>predictor</strong> and <span class="math notranslate nohighlight">\(y(t)\)</span> as the <strong>predictand</strong>. Sometimes <span class="math notranslate nohighlight">\(x(t)\)</span> is termed the <strong>independent variable</strong> and <span class="math notranslate nohighlight">\(y(t)\)</span> the <strong>dependent variable</strong>.</p>
<p>To begin, we have to define what <strong>“best-fit”</strong> means. We will use the conventional OLS definition which defines best-fit as the line that <em>reduces the sum of the squared errors of <span class="math notranslate nohighlight">\(y\)</span></em>.</p>
<div class="section" id="terminology">
<h3>Terminology<a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h3>
<p>We will define the equation for the best-fit line as,</p>
<div class="math notranslate nohighlight">
\[
\hat{y(t)} = a_1x(t) + a_0
\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{y(t)}\)</span> denotes the estimate of <span class="math notranslate nohighlight">\(y(t)\)</span> based on its linear relationship with <span class="math notranslate nohighlight">\(x(t)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(a_1\)</span> denotes the slope, aka the <strong>regression coefficient</strong></p></li>
<li><p><span class="math notranslate nohighlight">\(a_0\)</span> denotes the y-intercept</p></li>
</ul>
<p><a class="reference internal" href="#ols-schematic"><span class="std std-ref">Figure 11</span></a> shows what the best-fit line, <span class="math notranslate nohighlight">\(\hat{y(t)}\)</span>, between <span class="math notranslate nohighlight">\(y(t)\)</span> and <span class="math notranslate nohighlight">\(x(t)\)</span> looks like for some made-up data. <span class="math notranslate nohighlight">\(a_1\)</span> is the slope of this line and tells us the magnitude of the best-fit relationship between <span class="math notranslate nohighlight">\(y(t)\)</span> and <span class="math notranslate nohighlight">\(x(t)\)</span>. The y-intercept, <span class="math notranslate nohighlight">\(a_0\)</span> tells us the best-fit value for <span class="math notranslate nohighlight">\(\hat{y(t)}\)</span> when <span class="math notranslate nohighlight">\(x(t)\)</span> is zero.</p>
<div class="figure align-default" id="ols-schematic">
<a class="reference internal image-reference" href="../../_images/OLS_schematic.png"><img alt="../../_images/OLS_schematic.png" src="../../_images/OLS_schematic.png" style="width: 502.0px; height: 328.0px;" /></a>
<p class="caption"><span class="caption-number">Fig. 11 </span><span class="caption-text">Scatter plot of <span class="math notranslate nohighlight">\(y(t)\)</span> versus <span class="math notranslate nohighlight">\(x(t)\)</span> (blue dots) and the OLS best-fit line (red line). The distances in the y-direction from a blue dots to the red line are defined as the residuals.</span><a class="headerlink" href="#ols-schematic" title="Permalink to this image">¶</a></p>
</div>
<p>The <strong>residuals</strong> are differences between the fitted values, <span class="math notranslate nohighlight">\(\hat{y_i(t)}\)</span> and the actual values, <span class="math notranslate nohighlight">\(y_i(t)\)</span> as illustrated in <a class="reference internal" href="#ols-schematic"><span class="std std-ref">Figure 11</span></a>. The residuals describe the error in the linear fit - the smaller the residuals, the better the fit.</p>
</div>
<div class="section" id="sum-of-squared-errors">
<h3>Sum of Squared Errors<a class="headerlink" href="#sum-of-squared-errors" title="Permalink to this headline">¶</a></h3>
<p>As noted above, the best-fit line is the line that minimized the sum of squared errors, <span class="math notranslate nohighlight">\(Q\)</span>. But, what is <span class="math notranslate nohighlight">\(Q\)</span>? <span class="math notranslate nohighlight">\(Q\)</span> is sum of the squared residuals (aka the errors),</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
Q &amp;= \sum\limits_{i=1}^N(\hat{y_i(t)} - y_i(t))^2\\
&amp;= \sum\limits_{i=1}^N(a_1x(t) + a_0 - y_i(t))^2\\
\end{align}
\end{split}\]</div>
<p>where the subscript <span class="math notranslate nohighlight">\(i\)</span> denotes, e.g., the time step for time series data.</p>
<p>The errors are <em>squared</em> so that:</p>
<ul class="simple">
<li><p>the errors are positive definite (so positive and negative errors don’t cancel out). Note that the square causes larger errors to be more heavily weighted.</p></li>
<li><p>the minimization of Q (the derivative of Q (see below)) is a linear problem</p></li>
</ul>
</div>
<div class="section" id="the-best-fit-line-minimizing-q">
<h3>The Best-Fit Line: Minimizing <em>Q</em><a class="headerlink" href="#the-best-fit-line-minimizing-q" title="Permalink to this headline">¶</a></h3>
<p>We are now ready to find <span class="math notranslate nohighlight">\(a_0\)</span> and <span class="math notranslate nohighlight">\(a_1\)</span> that minimize <span class="math notranslate nohighlight">\(Q\)</span>. To do this, we take the derivative of <span class="math notranslate nohighlight">\(Q\)</span> with respect to <span class="math notranslate nohighlight">\(a_0\)</span> and <span class="math notranslate nohighlight">\(a_1\)</span>, separately and then solve for these coefficients. This involves a bit of calculus (painless, I promise!).</p>
<p>Let’s start by minimizing <span class="math notranslate nohighlight">\(Q\)</span> with respect to <span class="math notranslate nohighlight">\(a_0\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\frac{dQ}{da_0} &amp;= 0\\
0 &amp;= 2\sum\limits_{i=1}^N(a_1x(t) + a_0 - y_i(t))\\
0 &amp;= a_1\sum\limits_{i=1}^Nx(t) + a_0N - \sum\limits_{i=1}^Ny_i(t)\\
\end{align}
\end{split}\]</div>
<p>Now, let’s minimize <span class="math notranslate nohighlight">\(Q\)</span> with respect to <span class="math notranslate nohighlight">\(a_1\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\frac{dQ}{da_1} &amp;= 0\\
0 &amp;= 2\sum\limits_{i=1}^N(a_1x(t) + a_0 - y_i(t))x_i(t)\\
0 &amp;= a_1\sum\limits_{i=1}^Nx(t)^2 + a_0x_i(t) - \sum\limits_{i=1}^Nx_i(t)y_i(t)\\
\end{align}
\end{split}\]</div>
<p>For both of the above equations, we can do the sums, divide through by <span class="math notranslate nohighlight">\(N\)</span> and move the <span class="math notranslate nohighlight">\(y_i(t)\)</span> terms to the left hand side to get the following two equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\overline{y} &amp;= a_1\overline{x} + a_0\\
\overline{xy} &amp;= a_1\overline{x^2} + a_0\overline{x}
\end{align}
\end{split}\]</div>
<p>where overbars denote the mean.</p>
<p>Two equations, two unknowns: so we can solve for <span class="math notranslate nohighlight">\(a_0\)</span> and <span class="math notranslate nohighlight">\(a_1\)</span>! Yay!</p>
<p>To solve this, it helps to use the following expressions:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\overline{xy} &amp;= \overline{x}\overline{y} + \overline{x^{\prime}y^{\prime}}\\
\overline{x^2} &amp;= \overline{x}^2 + \overline{{x^\prime}^2}
\end{align}
\end{split}\]</div>
<p>Plugging these in, we get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
a_1 &amp;= \frac{\overline{x^{\prime}y^{\prime}}}{\overline{{x^\prime}^2}}\\
a_0 &amp;= \overline{y} - a_1\overline{x}
\end{align}
\end{split}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
a_1 &amp;= \frac{\overline{x^{\prime}y^{\prime}}}{\overline{{x^\prime}^2}}
\end{align}
\]</div>
<p><span class="math notranslate nohighlight">\(a_1\)</span> is:</p>
<ul class="simple">
<li><p>the slope of the best-fit line</p></li>
<li><p>the regression coefficient</p></li>
<li><p>equal to the <strong>covariance of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span></strong> divided by the <strong>variance of <span class="math notranslate nohighlight">\(x\)</span></strong></p></li>
</ul>
<hr class="docutils" />
<div class="math notranslate nohighlight">
\[
\begin{align}
a_0 &amp;= \overline{y} - a_1\overline{x}
\end{align}
\]</div>
<p><span class="math notranslate nohighlight">\(a_0\)</span> is:</p>
<ul class="simple">
<li><p>the y-intercept. Note that if the means of the time series are 0 (which is the case if <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are anomalies), then <span class="math notranslate nohighlight">\(a_0\)</span> = 0.</p></li>
</ul>
</div>
<p>Let’s revisit our ENSO and California precipitation example and calculate the best-fit line using OLS linear regression.</p>
</div>
</div>
<div class="section" id="example-revisited">
<h2>Example Revisited<a class="headerlink" href="#example-revisited" title="Permalink to this headline">¶</a></h2>
<p>We will learn two ways to calculate the best-fit line using python. The first way is using the numpy function called <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.polyfit.html">“polyfit”</a>. This function can be used to fit a polynomial of degree, <span class="math notranslate nohighlight">\(n\)</span>, but we will simply use it to fit a polynomial of degree 1 (which is a straight line).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate best-fit line</span>

<span class="c1"># np.polyfit(predictor, predictand, degree)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">nino34</span><span class="p">,</span><span class="n">precip_djfm</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#polynomial fit, degree = 1 means a linear fit</span>
</pre></div>
</div>
</div>
</div>
<p>The output of polyfit is an array with two elements, the slope and the y-intercept.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2,)
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at what we get.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The slope is&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot; and the y-intercept is&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The slope is 0.44  and the y-intercept is 2.5
</pre></div>
</div>
</div>
</div>
<p>In order to plot our best-fit line on our scatter plot, we need the <span class="math notranslate nohighlight">\(\hat{y(t)}\)</span> values. To obtain these values, we can either calculate them directly using the equation for <span class="math notranslate nohighlight">\(\hat{y(t)}\)</span> or we can use the numpy function, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.polyval.html#numpy.polyval"><code class="docutils literal notranslate"><span class="pre">polyval</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># construct the linear fit</span>

<span class="c1"># method 1: y_hat = ao + a1*x</span>
<span class="n">y_hat</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">nino34</span>

<span class="c1"># method 2: np.polyval()</span>
<span class="n">y_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">nino34</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we can add the best-fit line to our scatter plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#add linear fits to the plot above</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nino34</span><span class="p">,</span><span class="n">precip_djfm</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ElNinoyrs</span><span class="p">,</span><span class="n">ElNinoP</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;El Nino&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">LaNinayrs</span><span class="p">,</span><span class="n">LaNinaP</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;La Nina&#39;</span><span class="p">)</span>

<span class="c1"># add best-fit line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nino34</span><span class="p">,</span><span class="n">y_hat</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># labels, legends, etc.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;NINO3.4 ($^{\circ}$C)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CA Precipitation (mm day$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatter Plot: NINO3.4 vs. CA Precip&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fc854cead60&gt;
</pre></div>
</div>
<img alt="../../_images/basics_linreg_24_1.png" src="../../_images/basics_linreg_24_1.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "kls2177/Climate-and-Geophysical-Data-Analysis",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/Week3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="linreg.html" title="previous page">Linear Regression</a>
    <a class='right-next' id="next-link" href="confidence_intervals.html" title="next page">Confidence Intervals</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Karen Smith<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>