

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>EOFs with Real Data</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/Week7/naoeof';</script>
    <link rel="canonical" href="https://kls2177.github.io/Climate-and-Geophysical-Data-Analysis/chapters/index.html/chapters/Week7/naoeof.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/gistemp.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/gistemp.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    TEST
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/intro.html">Introduction</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/aboutthisbook.html">About this book</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/howtousethisbook.html">How to use this book</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week1a/whatarestatsgoodfor.html">What are statistics good for?</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week1a/goodpractice.html">Statistics is the grammar of science…</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week1a/pitfalls.html">Lies, damned lies and statistics…</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/kls2177/Climate-and-Geophysical-Data-Analysis/master?urlpath=tree/chapters/Week7/naoeof.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chapters/Week7/naoeof.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>EOFs with Real Data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-study-north-atlantic-oscillation-nao">Case Study: North Atlantic Oscillation (NAO)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-note-about-missing-data">A Note about Missing Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-remove-the-mean">Step 1: Remove the mean</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-standardizing-the-data-optional">Step 2: Standardizing the data (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-weighting-gridded-data">Step 3: Weighting gridded data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-convert-3d-array-to-2d-matrix">Step 4: Convert 3D array to 2D matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-calculate-the-covariance-matrix">Step 5: Calculate the covariance matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-perform-eigenanalysis-of-the-covariance-matrix">Step 6: Perform eigenanalysis of the covariance matrix</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#presenting-eofs-pcs">Presenting EOFs/PCs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-many-eofs-pcs-are-meaningful">How many EOFs/PCs are meaningful?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="eofs-with-real-data">
<h1>EOFs with Real Data<a class="headerlink" href="#eofs-with-real-data" title="Permalink to this headline">#</a></h1>
<p>We have now established how we can use PCA to extract the dominant patterns (aka “leading modes”) of variability in a multi-dimensional variable of interest. Now, we are going to work through an example and discuss some of the practicalities of PCA when working with climate and geophysical data sets.</p>
<section id="case-study-north-atlantic-oscillation-nao">
<h2>Case Study: North Atlantic Oscillation (NAO)<a class="headerlink" href="#case-study-north-atlantic-oscillation-nao" title="Permalink to this headline">#</a></h2>
<p>The example that we are going to look at is the North Atlantic Oscillation (NAO). The NAO is a weather and climate mode of variability in the North Atlantic region. It is characterized by fluctuations in the difference in anomalous sea-level pressure (SLP) between the Icelandic low and the Azores high. Fluctuations in the difference between SLP within the Icelandic low and Azores high, reflects fluctuations in the strength and position of westerly jet stream and storm tracks across the North Atlantic. The NAO is the leading mode of atmospheric variability via PCA in the North Atlantic extratropical region and is most active during the winter season.</p>
<p>Let’s begin by reading in some gridded, reanalysis SLP data. Reanalysis data products are quasi-observational data products that provide global coverage of atmospheric and surface variables. We will use SLP from the <a class="reference external" href="https://www.ecmwf.int/en/forecasts/datasets/reanalysis-datasets/era-interim">ERA-Interim</a> reanalysis product. You can download the netcdf file <a class="reference external" href="https://www.dropbox.com/s/brssg2g5m2tzn6y/ERAI_PSL_1980_2017.nc?dl=0">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load packages</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> <span class="c1">#set default font size and weight for plots</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data is from the ERA-Interim reanalysis data product.</span>
<span class="c1"># It was downloaded from http://apps.ecmwf.int/datasets/data/interim-full-moda/levtype=sfc/</span>
<span class="c1"># only Dec, Jan, Feb and Mar of each season are contained in this file</span>

<span class="c1"># open netcdf file</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;ERAI_PSL_1980_2017.nc&#39;</span> 
<span class="n">nc</span>    <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="n">slp</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;msl&#39;</span><span class="p">][:,:,:])</span>
<span class="n">lon</span>   <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">][:]</span>
<span class="n">lat</span>   <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">][:]</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at the shape of our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">slp</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">lat</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">lon</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(152, 241, 480) 241 480
</pre></div>
</div>
</div>
</div>
<p>Looks like we have a 3-D variable and the dimensions are in the following order: (time, lat, lon): 152 time points, 241 latitudes and 480 longitudes. Since the file that we have read in contains 4 months per year, we have 38 years of wintertime SLP data. For simplicity, let’s create December - March seasonal means.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create average winter seasons (Dec-Mar). </span>
<span class="n">slp_djfm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">slp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">lat</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">lon</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">slp_djfm</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(38, 241, 480)
</pre></div>
</div>
</div>
</div>
<p>Now, our time dimension reflects the 38 years of mean winter data. To get a sense of what this data looks like, let’s calculate the climatological mean SLP and plot it on a map using <code class="docutils literal notranslate"><span class="pre">cartopy</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate the climatological mean DJFM slp, i.e. average over all years</span>
<span class="n">slp_djfm_clim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">slp_djfm</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set up plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="c1"># define the map projection: the projection keyword determines how the plot will look</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">180</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="c1"># plot data</span>
<span class="n">pc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">slp_djfm_clim</span><span class="o">/</span><span class="mf">100.0</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdBu_r&quot;</span><span class="p">)</span>

<span class="c1"># add colorbar</span>
<span class="n">cax</span><span class="p">,</span><span class="n">kw</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">out</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Sea Level Pressure (hPa)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/059d1ecf7a3cf7ebaf39389d68e2e9dbd552fda2bed77ccc4b9c2bb22e6cee44.png" src="../../_images/059d1ecf7a3cf7ebaf39389d68e2e9dbd552fda2bed77ccc4b9c2bb22e6cee44.png" />
</div>
</div>
<p>This looks reasonable. We see higher SLP in the hot sub-tropical regions and lower SLP in the storm track regions.</p>
<p>Before we move on, we need to prepare our data a bit more. The NAO is defined for over the North Atlantic region: from 20-90<span class="math notranslate nohighlight">\(^{\circ}\)</span>N and 90<span class="math notranslate nohighlight">\(^{\circ}\)</span>W-30<span class="math notranslate nohighlight">\(^{\circ}\)</span>E, so we need to select the latitudes and longitudes that we are interested in. Let’s look at the latitude dimension first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 90.    89.25  88.5   87.75  87.    86.25  85.5   84.75  84.    83.25
  82.5   81.75  81.    80.25  79.5   78.75  78.    77.25  76.5   75.75
  75.    74.25  73.5   72.75  72.    71.25  70.5   69.75  69.    68.25
  67.5   66.75  66.    65.25  64.5   63.75  63.    62.25  61.5   60.75
  60.    59.25  58.5   57.75  57.    56.25  55.5   54.75  54.    53.25
  52.5   51.75  51.    50.25  49.5   48.75  48.    47.25  46.5   45.75
  45.    44.25  43.5   42.75  42.    41.25  40.5   39.75  39.    38.25
  37.5   36.75  36.    35.25  34.5   33.75  33.    32.25  31.5   30.75
  30.    29.25  28.5   27.75  27.    26.25  25.5   24.75  24.    23.25
  22.5   21.75  21.    20.25  19.5   18.75  18.    17.25  16.5   15.75
  15.    14.25  13.5   12.75  12.    11.25  10.5    9.75   9.     8.25
   7.5    6.75   6.     5.25   4.5    3.75   3.     2.25   1.5    0.75
   0.    -0.75  -1.5   -2.25  -3.    -3.75  -4.5   -5.25  -6.    -6.75
  -7.5   -8.25  -9.    -9.75 -10.5  -11.25 -12.   -12.75 -13.5  -14.25
 -15.   -15.75 -16.5  -17.25 -18.   -18.75 -19.5  -20.25 -21.   -21.75
 -22.5  -23.25 -24.   -24.75 -25.5  -26.25 -27.   -27.75 -28.5  -29.25
 -30.   -30.75 -31.5  -32.25 -33.   -33.75 -34.5  -35.25 -36.   -36.75
 -37.5  -38.25 -39.   -39.75 -40.5  -41.25 -42.   -42.75 -43.5  -44.25
 -45.   -45.75 -46.5  -47.25 -48.   -48.75 -49.5  -50.25 -51.   -51.75
 -52.5  -53.25 -54.   -54.75 -55.5  -56.25 -57.   -57.75 -58.5  -59.25
 -60.   -60.75 -61.5  -62.25 -63.   -63.75 -64.5  -65.25 -66.   -66.75
 -67.5  -68.25 -69.   -69.75 -70.5  -71.25 -72.   -72.75 -73.5  -74.25
 -75.   -75.75 -76.5  -77.25 -78.   -78.75 -79.5  -80.25 -81.   -81.75
 -82.5  -83.25 -84.   -84.75 -85.5  -86.25 -87.   -87.75 -88.5  -89.25
 -90.  ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract only latitudes 20N-90N</span>
<span class="n">lat_nao</span> <span class="o">=</span> <span class="n">lat</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">94</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now, let’s take a look at the longitude dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  0.     0.75   1.5    2.25   3.     3.75   4.5    5.25   6.     6.75
   7.5    8.25   9.     9.75  10.5   11.25  12.    12.75  13.5   14.25
  15.    15.75  16.5   17.25  18.    18.75  19.5   20.25  21.    21.75
  22.5   23.25  24.    24.75  25.5   26.25  27.    27.75  28.5   29.25
  30.    30.75  31.5   32.25  33.    33.75  34.5   35.25  36.    36.75
  37.5   38.25  39.    39.75  40.5   41.25  42.    42.75  43.5   44.25
  45.    45.75  46.5   47.25  48.    48.75  49.5   50.25  51.    51.75
  52.5   53.25  54.    54.75  55.5   56.25  57.    57.75  58.5   59.25
  60.    60.75  61.5   62.25  63.    63.75  64.5   65.25  66.    66.75
  67.5   68.25  69.    69.75  70.5   71.25  72.    72.75  73.5   74.25
  75.    75.75  76.5   77.25  78.    78.75  79.5   80.25  81.    81.75
  82.5   83.25  84.    84.75  85.5   86.25  87.    87.75  88.5   89.25
  90.    90.75  91.5   92.25  93.    93.75  94.5   95.25  96.    96.75
  97.5   98.25  99.    99.75 100.5  101.25 102.   102.75 103.5  104.25
 105.   105.75 106.5  107.25 108.   108.75 109.5  110.25 111.   111.75
 112.5  113.25 114.   114.75 115.5  116.25 117.   117.75 118.5  119.25
 120.   120.75 121.5  122.25 123.   123.75 124.5  125.25 126.   126.75
 127.5  128.25 129.   129.75 130.5  131.25 132.   132.75 133.5  134.25
 135.   135.75 136.5  137.25 138.   138.75 139.5  140.25 141.   141.75
 142.5  143.25 144.   144.75 145.5  146.25 147.   147.75 148.5  149.25
 150.   150.75 151.5  152.25 153.   153.75 154.5  155.25 156.   156.75
 157.5  158.25 159.   159.75 160.5  161.25 162.   162.75 163.5  164.25
 165.   165.75 166.5  167.25 168.   168.75 169.5  170.25 171.   171.75
 172.5  173.25 174.   174.75 175.5  176.25 177.   177.75 178.5  179.25
 180.   180.75 181.5  182.25 183.   183.75 184.5  185.25 186.   186.75
 187.5  188.25 189.   189.75 190.5  191.25 192.   192.75 193.5  194.25
 195.   195.75 196.5  197.25 198.   198.75 199.5  200.25 201.   201.75
 202.5  203.25 204.   204.75 205.5  206.25 207.   207.75 208.5  209.25
 210.   210.75 211.5  212.25 213.   213.75 214.5  215.25 216.   216.75
 217.5  218.25 219.   219.75 220.5  221.25 222.   222.75 223.5  224.25
 225.   225.75 226.5  227.25 228.   228.75 229.5  230.25 231.   231.75
 232.5  233.25 234.   234.75 235.5  236.25 237.   237.75 238.5  239.25
 240.   240.75 241.5  242.25 243.   243.75 244.5  245.25 246.   246.75
 247.5  248.25 249.   249.75 250.5  251.25 252.   252.75 253.5  254.25
 255.   255.75 256.5  257.25 258.   258.75 259.5  260.25 261.   261.75
 262.5  263.25 264.   264.75 265.5  266.25 267.   267.75 268.5  269.25
 270.   270.75 271.5  272.25 273.   273.75 274.5  275.25 276.   276.75
 277.5  278.25 279.   279.75 280.5  281.25 282.   282.75 283.5  284.25
 285.   285.75 286.5  287.25 288.   288.75 289.5  290.25 291.   291.75
 292.5  293.25 294.   294.75 295.5  296.25 297.   297.75 298.5  299.25
 300.   300.75 301.5  302.25 303.   303.75 304.5  305.25 306.   306.75
 307.5  308.25 309.   309.75 310.5  311.25 312.   312.75 313.5  314.25
 315.   315.75 316.5  317.25 318.   318.75 319.5  320.25 321.   321.75
 322.5  323.25 324.   324.75 325.5  326.25 327.   327.75 328.5  329.25
 330.   330.75 331.5  332.25 333.   333.75 334.5  335.25 336.   336.75
 337.5  338.25 339.   339.75 340.5  341.25 342.   342.75 343.5  344.25
 345.   345.75 346.5  347.25 348.   348.75 349.5  350.25 351.   351.75
 352.5  353.25 354.   354.75 355.5  356.25 357.   357.75 358.5  359.25]
</pre></div>
</div>
</div>
</div>
<p>The region that we are intersted in, the North Atlantic, straddles the Greenwich meridion, 0<span class="math notranslate nohighlight">\(^{\circ}\)</span>. So, we need to rearrange our longitude dimension and our SLP data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># only longitudes 90W-30E</span>
<span class="n">lon1</span> <span class="o">=</span> <span class="n">lon</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">41</span><span class="p">]</span>
<span class="n">lon2</span> <span class="o">=</span> <span class="n">lon</span><span class="p">[</span><span class="mi">360</span><span class="p">:</span><span class="mi">480</span><span class="p">]</span> <span class="o">-</span> <span class="mi">360</span> <span class="c1"># subtract 360 degrees in order to create a monotonically increasing longitude dimension for plotting</span>
<span class="n">lon_nao</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">lon2</span><span class="p">,</span><span class="n">lon1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s slice the SLP data accordingly to isolate the North Atlantic region.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slp_djfm1</span> <span class="o">=</span> <span class="n">slp_djfm</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">94</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">41</span><span class="p">]</span>
<span class="n">slp_djfm2</span> <span class="o">=</span> <span class="n">slp_djfm</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">94</span><span class="p">,</span><span class="mi">360</span><span class="p">:</span><span class="mi">480</span><span class="p">]</span>
<span class="n">slp_djfm_nao</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">slp_djfm2</span><span class="p">,</span><span class="n">slp_djfm1</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s plot this regional data to make sure we have selected our region correctly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set up plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="c1"># define the map projection: the projection keyword determines how the plot will look</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="c1"># added ax.set_extent</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>

<span class="c1"># plot data</span>
<span class="n">pc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon_nao</span><span class="p">,</span><span class="n">lat_nao</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">slp_djfm_nao</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="mf">100.0</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdBu_r&quot;</span><span class="p">)</span>

<span class="c1"># add colorbar</span>
<span class="n">cax</span><span class="p">,</span><span class="n">kw</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">out</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Sea Level Pressure (hPa)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1eb6f724184b51171e4fc42e11adff3d1874986312ac45232104ed7f91cafa06.png" src="../../_images/1eb6f724184b51171e4fc42e11adff3d1874986312ac45232104ed7f91cafa06.png" />
</div>
</div>
<section id="a-note-about-missing-data">
<h3>A Note about Missing Data<a class="headerlink" href="#a-note-about-missing-data" title="Permalink to this headline">#</a></h3>
<p>Most statistical algorithms for eigenanalysis with not work with missing values or NaNs. These missing values will have to be filled with something. In the introduction section, we filled them with zeros. In the NAO example that we are working on, there are no missing values in our data.</p>
<p>This now brings us to the first step of EOF analysis.</p>
</section>
<section id="step-1-remove-the-mean">
<h3>Step 1: Remove the mean<a class="headerlink" href="#step-1-remove-the-mean" title="Permalink to this headline">#</a></h3>
<p>It is typical to remove the sampling dimension mean, which is usually the time dimension. This will result in your principal component time series having a mean of zero. You may also want to remove the seasonal or diurnal cycle if this is not of interest to you.</p>
<p>It is less common to remove the spatial mean. For example, suppose you are interested in the gradients in temperature, not the full temperature field itself or you are interested in the “wavy” component of the field, so you might remove the zonal mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove the time mean, i.e., calculate anomalies (subtract the mean over each time series for each grid point)</span>
<span class="n">slp_djfm_anom_nao</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">anom</span><span class="p">(</span><span class="n">slp_djfm_nao</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-standardizing-the-data-optional">
<h3>Step 2: Standardizing the data (optional)<a class="headerlink" href="#step-2-standardizing-the-data-optional" title="Permalink to this headline">#</a></h3>
<p>Sometimes, it is desirable to take the amplitude of the variability out of the data before doing EOF analysis. For example, you may want to do this if</p>
<ul class="simple">
<li><p>your data is made of a combination of parameters with different units, and you don’t want the parameter with the biggest units to dominate the variance</p></li>
<li><p>if the variance of the data varies greatly in space (and this is not of interest to you)</p></li>
</ul>
<p>In order to do this, you divide your anomaly data by its standard deviation as well (now your data is in units of <span class="math notranslate nohighlight">\(\sigma\)</span>). For the NAO example, we will not standardize the data as we are interested in capturing the spatial the magnitude of the variability.</p>
</section>
<section id="step-3-weighting-gridded-data">
<h3>Step 3: Weighting gridded data<a class="headerlink" href="#step-3-weighting-gridded-data" title="Permalink to this headline">#</a></h3>
<p>If the data is gridded, you need to weight the data according to the grid box area. For example, if the data is on a rectangular grid on a sphere (like in our example), the size of the grid boxes decreases as you move from the equator to the poles. There are two considerations with doing area weighting on a sphere:</p>
<ul class="simple">
<li><p>if you are calculating EOFs using the covariance matrix and you are analyzing the <em>temporal covariance matrix</em> (i.e., your covariance matrix is <span class="math notranslate nohighlight">\(\mathbf{C} = \mathbf{XX^T}\)</span> <span class="math notranslate nohighlight">\([M x M]\)</span>, where <span class="math notranslate nohighlight">\(M\)</span> is the time dimension), you weight by <span class="math notranslate nohighlight">\(\sqrt{\text{cos}(\theta)}\)</span>. We use the square-root since when you multiply the grid points by each other you will get your full <span class="math notranslate nohighlight">\(\text{cos}(\theta)\)</span> in your covariance matrix (where <span class="math notranslate nohighlight">\(\theta\)</span> is latitude in radians)</p></li>
<li><p>if you are calculating EOFs using the covariance matrix and you are analyzing the <em>spatial dispersion matrix</em> (i.e., your covariance matrix is <span class="math notranslate nohighlight">\(\mathbf{C} = \mathbf{X^TX}\)</span> <span class="math notranslate nohighlight">\([N x N]\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the spatial dimension), you weight by <span class="math notranslate nohighlight">\(\text{cos}(\theta)\)</span> but have to be careful about this. Specifically, you weight your covariance matrix in the following way: <span class="math notranslate nohighlight">\(\mathbf{C} = \mathbf{X^TX_{cos}}\)</span>, where the elements of <span class="math notranslate nohighlight">\(\mathbf{X_{cos}}\)</span> are given by <span class="math notranslate nohighlight">\(x(t,\theta)\text{cos}(\theta)\)</span>.</p></li>
</ul>
<p>Note that the resulting EOFs will look unphysical and have unphysical values, this will be remedied when we discuss how to present EOFs (see below).</p>
<p>In the introduction to PCA section, we did not cosine-weight the data. This is because our analysis was focused on the tropical region, where the size of the grid boxes does not change too much. But, it is generally good practice to cosine-weight your data.</p>
<p>So, let’s continue our example and cosine-weight our SLP data. We are going to construct the <em>temporal covariance matrix</em>, so we will weight our data by the square-root of the cosine of latitude. In the previous section, it was noted that the <em>spatial dispersion matrix</em> is often preferred, but for this example, it will take too long to run.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># square-root cosine-weight</span>
<span class="n">cos_wgt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">lat_nao</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">)))</span> <span class="c1"># must be in radians</span>

<span class="n">slp_djfm_anom_cw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">slp_djfm_anom_nao</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">slp_djfm_anom_nao</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">slp_djfm_anom_nao</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">slp_djfm_anom_nao</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">slp_djfm_anom_nao</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
        <span class="n">slp_djfm_anom_cw</span><span class="p">[</span><span class="n">i</span><span class="p">,:,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">cos_wgt</span><span class="o">*</span><span class="n">slp_djfm_anom_nao</span><span class="p">[</span><span class="n">i</span><span class="p">,:,</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4-convert-3d-array-to-2d-matrix">
<h3>Step 4: Convert 3D array to 2D matrix<a class="headerlink" href="#step-4-convert-3d-array-to-2d-matrix" title="Permalink to this headline">#</a></h3>
<p>The next step is to convert our 3D array into a 2D matrix, so that we can perform matrix operations, specifically so that we can calculate the covariance matrix. We do this by combining all the spatial dimensions together.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reshape the array to have one time dimension and one spatial dimension (Nt = time, Ny = latitude, Nx = longitude)</span>
<span class="n">Nt</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">Nx</span> <span class="o">=</span> <span class="n">slp_djfm_anom_cw</span><span class="o">.</span><span class="n">shape</span>
<span class="n">slp_djfm_anom_cw</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">Nt</span><span class="p">,</span> <span class="n">Ny</span><span class="o">*</span><span class="n">Nx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The new dimensions of our SLP data array are:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Nt</span><span class="p">,</span> <span class="n">Ny</span><span class="o">*</span><span class="n">Nx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>38 15134
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5-calculate-the-covariance-matrix">
<h3>Step 5: Calculate the covariance matrix<a class="headerlink" href="#step-5-calculate-the-covariance-matrix" title="Permalink to this headline">#</a></h3>
<p>Our data is now ready for us to calculate the covariance matrix. Remember that we are going to calculate the temporal covariance matrix due to the slow computation speed associated with calculating the spatial dispersion matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate the covariance matrix</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">slp_djfm_anom_cw</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(38, 38)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-6-perform-eigenanalysis-of-the-covariance-matrix">
<h3>Step 6: Perform eigenanalysis of the covariance matrix<a class="headerlink" href="#step-6-perform-eigenanalysis-of-the-covariance-matrix" title="Permalink to this headline">#</a></h3>
<p>The next step is the eigenanalysis. Note that because we are eigenanalyzing the temporal covariance matrix, which is <span class="math notranslate nohighlight">\([M x M]\)</span>, the eigenvectors will be <span class="math notranslate nohighlight">\([M x 1]\)</span>, not <span class="math notranslate nohighlight">\([N x 1]\)</span> as in the conceptual example in the last section. The implications of this are that the eigenvectors correspond to the principal component time series and we will calculate the spatial patterns, the EOFs, by performing a linear transformation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># eigenanalyze C</span>
<span class="n">LAM</span><span class="p">,</span> <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract the 1st eigenvector/principal component time series</span>
<span class="n">pc_ts</span> <span class="o">=</span> <span class="n">E</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pc_ts</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(38,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute the 1st EOF</span>
<span class="c1"># the EOFs are computed by projecting the data matrix onto the PC time series</span>
<span class="n">nao_pat</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">slp_djfm_anom_cw</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">E</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nx</span><span class="p">))</span> 
</pre></div>
</div>
</div>
</div>
<p>Note that we project the <em>weighted</em> data matrix onto the PC time series as this is what was used to calculate the covariance matrix.</p>
<p>Let’s plot the EOF and PC time series to see what they look like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># look at first eof pattern and pc timeseries</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="c1"># added ax.set_extent</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;EOF 1&#39;</span><span class="p">)</span>
<span class="n">pc</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon_nao</span><span class="p">,</span> <span class="n">lat_nao</span><span class="p">,</span> <span class="n">nao_pat</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">)</span>
<span class="n">cax</span><span class="p">,</span><span class="n">kw</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.55</span><span class="p">)</span>
<span class="n">out</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pc_ts</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PC 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b476a41b7e104a80d1a3abc28fab5a5cc2bb3f38d6a465a20e856c327044d4e6.png" src="../../_images/b476a41b7e104a80d1a3abc28fab5a5cc2bb3f38d6a465a20e856c327044d4e6.png" />
</div>
</div>
</section>
</section>
<section id="presenting-eofs-pcs">
<h2>Presenting EOFs/PCs<a class="headerlink" href="#presenting-eofs-pcs" title="Permalink to this headline">#</a></h2>
<p>The EOFs <span class="math notranslate nohighlight">\(\mathbf{E}\)</span> and PC time series <span class="math notranslate nohighlight">\(\mathbf{Z}\)</span> that result from eigenanalysis of <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> are typically not in physical units. Recall that we have cosine-weighted our data and that the eigenvectors are unit vectors. Thus, there are a few post-processing steps that we need to go through in order to present our EOFs/PCs in a meaningful way.</p>
<p>Let <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> have dimensions <span class="math notranslate nohighlight">\([M x N]\)</span> such that <span class="math notranslate nohighlight">\(M\)</span> is the number of observations and <span class="math notranslate nohighlight">\(N\)</span> is the number spatial locations. From now on, to make notation a bit easier, we will only write equations using EOF 1 and PC 1. The steps can be repeated for EOF 2 and PC 2, EOF 3 and PC 3, etc.</p>
<p>Typically, we convert the PC time series to units of standard deviation. So, we simply need to standardize <span class="math notranslate nohighlight">\(\mathbf{Z}\)</span> to create an index.</p>
<p>We then project <span class="math notranslate nohighlight">\(\mathbf{Z}\)</span> back onto your original anomaly data and divide by the length of <span class="math notranslate nohighlight">\(\mathbf{Z}\)</span> to get <span class="math notranslate nohighlight">\(\mathbf{D}\)</span>, the EOF 1 structure in the original units i.e. the unweighted data <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>. If <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> was standardized before the computation, the non-standardized data should be used.</p>
<p>If the original data is <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>, the weighted data is <span class="math notranslate nohighlight">\(\mathbf{X_{cos}}\)</span>, we write the PC time series as,</p>
<div class="math notranslate nohighlight">
\[
\mathbf{z_1} = \mathbf{X_{cos}e_1}
\]</div>
<p>The standardized PC time series is then simply,</p>
<div class="math notranslate nohighlight">
\[
\mathbf{\tilde{z_1}} = \frac{z_1 - \mu_{z_1}}{\sigma_{z_1}}
\]</div>
<p>and the EOF in physical units is,</p>
<div class="math notranslate nohighlight">
\[
\mathbf{d_1} = \frac{1}{M}\mathbf{\tilde{z_1}^TX}
\]</div>
<p><span class="math notranslate nohighlight">\(\mathbf{d_1}\)</span> is now in the physical units of your data, and represents the anomaly associated with one a standard deviation variation of <span class="math notranslate nohighlight">\(\mathbf{z_1}\)</span>.</p>
<p>Note that you can project <span class="math notranslate nohighlight">\(\mathbf{\tilde{z_1}}\)</span> onto other variables as well. For example, in the case of the NAO, we can project <span class="math notranslate nohighlight">\(\mathbf{\tilde{z_1}}\)</span> onto the temperature or zonal wind in the North Atlantic to see how these variables vary with the NAO index.</p>
<p>Let’s take a look at how this is done using our NAO example. First, we standardize the PC time series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># standardize PC 1 time series</span>
<span class="n">pc_ts_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">pc_ts</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pc_ts</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">pc_ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we project this standardized time series onto our original, unweighted data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert the EOF into physical units</span>

<span class="c1"># first reshape original data from 3D to 2D</span>
<span class="n">slp_djfm_anom_nao</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">Nt</span><span class="p">,</span> <span class="n">Ny</span><span class="o">*</span><span class="n">Nx</span><span class="p">)</span>

<span class="c1"># project standardized PC 1 time series onto data</span>
<span class="n">nao_pat_phys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">pc_ts_std</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">slp_djfm_anom_nao</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">pc_ts_std</span><span class="p">))</span>

<span class="c1">#reshape back for plotting</span>
<span class="n">nao_pat_phys</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nao_pat_phys</span><span class="p">,</span> <span class="p">(</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nx</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We can now plot EOF 1 and PC 1 in such a way that we can better interpret their meaning.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># look at first eof pattern and pc timeseries</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="c1"># added ax.set_extent</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;EOF 1 (NAO Pattern)&#39;</span><span class="p">)</span>
<span class="n">pc</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon_nao</span><span class="p">,</span> <span class="n">lat_nao</span><span class="p">,</span> <span class="n">nao_pat_phys</span><span class="o">/</span><span class="mf">100.0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">)</span>
<span class="n">cax</span><span class="p">,</span><span class="n">kw</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">out</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Sea Level Pressure (hPa)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pc_ts_std</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PC 1 (NAO Index)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;STDEV&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/07542051533e84677fc6bf9b16dd809c6e7df257518170428b309a507e70a2ed.png" src="../../_images/07542051533e84677fc6bf9b16dd809c6e7df257518170428b309a507e70a2ed.png" />
</div>
</div>
<p>So, this is our NAO pattern and NAO Index. The pattern that we get shows a dipole in SLP. A +1 standard deviation value of our PC time series corresponds to exactly this pattern, while a -1 standard deviation corresponds to exactly -1 x this pattern. The standard definition of the NAO is actually opposite to what we are seeing above. Recall that eigenvectors can span either the positive part or the negative part of a particular dimension. What we are seeing above is actually the negative phase of the NAO. If we multiply both the NAO pattern and NAO Index by -1, we get the standard definition of the NAO.</p>
<p>Let’s take a look at projecting the PC time series onto the zonal wind at 500 hPa (mid-troposphere).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#open netcdf file</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;ERAI_U500_1980_2017.nc&#39;</span>
<span class="n">nc</span>    <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="n">u500</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">nc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;u&#39;</span><span class="p">][:,:,:])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create average winter seasons (Dec-Mar). </span>
<span class="n">u500_djfm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">u500</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">lat</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">lon</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># compute anomaly</span>
<span class="n">u500_djfm_anom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">anom</span><span class="p">(</span><span class="n">u500_djfm</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># extract u500 for the NAO region latitudes and longitudes</span>
<span class="n">u500_djfm_anom1</span> <span class="o">=</span> <span class="n">u500_djfm_anom</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">94</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">41</span><span class="p">]</span>
<span class="n">u500_djfm_anom2</span> <span class="o">=</span> <span class="n">u500_djfm_anom</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">94</span><span class="p">,</span><span class="mi">360</span><span class="p">:</span><span class="mi">480</span><span class="p">]</span>
<span class="n">u500_djfm_anom_nao</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">u500_djfm_anom2</span><span class="p">,</span><span class="n">u500_djfm_anom1</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we perform the projection in the same way that we did for the SLP data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reshape 3D array to 2D matrix </span>
<span class="n">u500_djfm_anom_nao</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">Nt</span><span class="p">,</span> <span class="n">Ny</span><span class="o">*</span><span class="n">Nx</span><span class="p">)</span>

<span class="c1"># project PC 1 onto zonal wind</span>
<span class="n">u_proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">pc_ts_std</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">u500_djfm_anom_nao</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pc_ts_std</span><span class="p">))</span>

<span class="c1">#reshape for plotting</span>
<span class="n">u_nao_phys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">u_proj</span><span class="p">,</span> <span class="p">(</span><span class="n">Ny</span><span class="p">,</span><span class="n">Nx</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>This projection represents the zonal wind anomaly (in m/s) associated with one a standard deviation variation of <span class="math notranslate nohighlight">\(\mathbf{z_1}\)</span>. What does this look like?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># look at first eof pattern and pc timeseries</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="c1"># added ax.set_extent</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Zonal Wind Anomaly Associated with NAO&#39;</span><span class="p">)</span>
<span class="n">pc</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon_nao</span><span class="p">,</span> <span class="n">lat_nao</span><span class="p">,</span> <span class="n">u_nao_phys</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">)</span>
<span class="n">cax</span><span class="p">,</span><span class="n">kw</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">out</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Zonal Wind at 500 hPa (m/s)&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pc_ts_std</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PC 1 (NAO Index)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;STDEV&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/88fe93176e2735885b1bb07024ad0b4bc7b0923a18a712a39008fd4d0f94c7ce.png" src="../../_images/88fe93176e2735885b1bb07024ad0b4bc7b0923a18a712a39008fd4d0f94c7ce.png" />
</div>
</div>
</section>
<section id="how-many-eofs-pcs-are-meaningful">
<h2>How many EOFs/PCs are meaningful?<a class="headerlink" href="#how-many-eofs-pcs-are-meaningful" title="Permalink to this headline">#</a></h2>
<p>Eigenanalysis of the covariance matrix will always give you an answer. The orthogonality of the eigenvectors/EOFs imposes a constraint on their pattern. Higher order EOFs are often trying to represent the noise while still being orthogonal to the other EOFs and, consequently, these patterns can become spurious statistical constructs rather than physically meaningful modes of variability.</p>
<p><a class="reference external" href="https://journals.ametsoc.org/mwr/article/110/7/699/62757/Sampling-Errors-in-the-Estimation-of-Empirical">North et al. (1982)</a> argues that the significance or robustness of an EOF is a function of the degree of separation between eigenvalues, where the 95% confidence bounds on the eigenvalues is,</p>
<div class="math notranslate nohighlight">
\[
\Delta\lambda = \lambda\sqrt{\frac{2}{N^*}}
\]</div>
<p>In this case, the N<span class="math notranslate nohighlight">\(^*\)</span> is our friend the “effective sample size”. It is not obvious how to decide what N<span class="math notranslate nohighlight">\(^*\)</span> is - you need to come up with a value that is representative of the entire data set! Here, we will simply use the number of eigenvectors, although this is a liberal estimate.</p>
<p>The separation between eigenvalues is often plotted showing the variance explained by each eigenvalue along with its confidence interval. If the confidence intervals overlap, then the EOFs are not separable - they do not represent distinct patterns of variability.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set up plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="c1"># plot fraction of variance explained by first 10 eigenvectors using the eigenvalues</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">LAM</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span><span class="o">+</span><span class="mf">1.</span><span class="p">),</span><span class="n">LAM</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="o">/</span> <span class="n">LAM</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="s1">&#39;.-&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">)</span>

<span class="c1"># define N*</span>
<span class="n">Nstar</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pc_ts_std</span><span class="p">)</span>

<span class="c1"># compute error bars using the North et al. &quot;rule of thumb&quot;</span>
<span class="n">eb</span> <span class="o">=</span> <span class="n">LAM</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="o">/</span> <span class="n">LAM</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">Nstar</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">LAM</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span><span class="o">+</span><span class="mf">1.</span><span class="p">),</span><span class="n">LAM</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="o">/</span> <span class="n">LAM</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="n">yerr</span> <span class="o">=</span> <span class="n">eb</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">xerr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="c1"># add labels, title, etc.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fraction of Variance Explained&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;EOFs&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8a72fa7877ea7764bc7150369bcb085ed90b486e133a9b72f049b70c00014783.png" src="../../_images/8a72fa7877ea7764bc7150369bcb085ed90b486e133a9b72f049b70c00014783.png" />
</div>
</div>
<p>The first three EOFs are clearly separable and, therefore, likely physically meaningful, but the error bars start to overlap beyond that.</p>
<p>The robustness of EOFs can also be established by asking the following questions:</p>
<ul class="simple">
<li><p>if you subdivide your sample, compute the EOFs for each sub-sample and compare the EOF structures, do they look roughly the same?</p></li>
<li><p>are the patterns you obtain explainable through theory?</p></li>
<li><p>are your results sensitive to the size of the spatial domain?</p></li>
</ul>
<p>Remember that EOFs/PCs are statistical, not physical. There is often a physical explanation behind the statistical patterns obtained through PCA, but not always.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "kls2177/Climate-and-Geophysical-Data-Analysis",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters/Week7"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-study-north-atlantic-oscillation-nao">Case Study: North Atlantic Oscillation (NAO)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-note-about-missing-data">A Note about Missing Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-remove-the-mean">Step 1: Remove the mean</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-standardizing-the-data-optional">Step 2: Standardizing the data (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-weighting-gridded-data">Step 3: Weighting gridded data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-convert-3d-array-to-2d-matrix">Step 4: Convert 3D array to 2D matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-calculate-the-covariance-matrix">Step 5: Calculate the covariance matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-perform-eigenanalysis-of-the-covariance-matrix">Step 6: Perform eigenanalysis of the covariance matrix</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#presenting-eofs-pcs">Presenting EOFs/PCs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-many-eofs-pcs-are-meaningful">How many EOFs/PCs are meaningful?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Karen Smith
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>