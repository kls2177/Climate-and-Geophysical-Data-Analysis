

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>EOFs via Eigenanalysis &#8212; Climate and Geophysical Data Analysis</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/Week7/eofs';</script>
    <link rel="canonical" href="https://kls2177.github.io/Climate-and-Geophysical-Data-Analysis/chapters/index.html/chapters/Week7/eofs.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/gistemp.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/gistemp.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Climate and Geophysical Data Analysis
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/intro.html">Introduction</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/aboutthisbook.html">About this book</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/howtousethisbook.html">How to use this book</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week1a/whatarestatsgoodfor.html">What are statistics good for?</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week1a/goodpractice.html">Statistics is the grammar of science…</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week1a/pitfalls.html">Lies, damned lies and statistics…</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/kls2177/Climate-and-Geophysical-Data-Analysis/master?urlpath=tree/chapters/Week7/eofs.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chapters/Week7/eofs.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>EOFs via Eigenanalysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-problem">Setting up the Problem…</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#maximizing-the-resemblance-of-mathbf-e-1-onto-x-eigenanalysis-of-c">Maximizing the resemblance of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> onto <strong>X</strong> = Eigenanalysis of <strong>C</strong>!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-points">Key Points:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principal-component-time-series-change-of-basis">Principal Component Time Series = Change of Basis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-finding-eofs-pcs">Summary of finding EOFs/PCs</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="eofs-via-eigenanalysis">
<h1>EOFs via Eigenanalysis<a class="headerlink" href="#eofs-via-eigenanalysis" title="Permalink to this headline">#</a></h1>
<p>In this section, we will discuss why an eigenanalysis of the covariance matrix (PCA or empirical orthogonal functions (EOFs) analysis) is a sensible approach to identifying patterns of variability in climate and geophysical data. There are many other approaches, but in this course, we will restrict ourselfves to PCA.</p>
<p>First, a few notes on terminology:</p>
<ul class="simple">
<li><p>EOF stands for <em>Empirical Orthogonal Functions</em></p></li>
<li><p>PCA stands for <em>Principal Component Analysis</em></p></li>
<li><p>EOF analysis and PCA are practically the same thing</p></li>
<li><p>PCA is the more generally used term, and just implies converting a matrix into sets of linearly uncorrelated variables, called principle components.</p></li>
<li><p>EOF analysis normally refers to finding the principle components that maximize the variance explained (i.e., a subset of all PC’s)</p></li>
</ul>
<section id="setting-up-the-problem">
<h2>Setting up the Problem…<a class="headerlink" href="#setting-up-the-problem" title="Permalink to this headline">#</a></h2>
<p>Say we have a data matrix <strong>X</strong> which is <span class="math notranslate nohighlight">\([M x N]\)</span>. For now, let the rows denote different times and the columns different spatial locations (although this is not required for the actual application).</p>
<p>The goal of EOF analysis is to decompose <strong>X</strong> into a set of spatial patterns, i.e, orthogonal eigenvectors, <span class="math notranslate nohighlight">\(\mathbf{e_i}\)</span>’s, that explain the most variance of <strong>X</strong>. In other words, we want to maximize the resemblance of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> (dimension <span class="math notranslate nohighlight">\([N x 1]\)</span>, the spatial dimension) to the data, that is, find the <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> that explains the most variance.</p>
<p><a class="reference internal" href="#eofs"><span class="std std-ref">Figure 26</span></a> provides a visualization of what we are trying to accomplish. <strong>X</strong> is a data matrix consisting of sea-level pressure (SLP) in mb at <span class="math notranslate nohighlight">\(N\)</span> points in space and <span class="math notranslate nohighlight">\(M\)</span> points in time.</p>
<figure class="align-default" id="eofs">
<a class="reference internal image-reference" href="../../_images/eofs.png"><img alt="../../_images/eofs.png" src="../../_images/eofs.png" style="width: 703.0px; height: 549.0px;" /></a>
<figcaption>
<p><span class="caption-text">Visualizing EOF/PC spatial patterns using daily sea-level pressure (mb) anomalies. <strong>X</strong> is the data matrix and <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> is the eigenvector that explains the largest fraction of the variability in <strong>X</strong>.</span><a class="headerlink" href="#eofs" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The first eigenvector, <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span>, shows the pattern that explains the most variance in <strong>X</strong>. Note that just like the unit eigenvectors of 2-D or 3-D space, where <span class="math notranslate nohighlight">\(\mathbf{e_1} = (1,0)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{e_1} = (-1,0)\)</span> are both legitimate eigenvectors, <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> describing the variance of <strong>X</strong> can look like the pattern in <a class="reference internal" href="#eofs"><span class="std std-ref">Figure 26</span></a> or it can look like -1 <em>x</em> this pattern.</p>
</section>
<section id="maximizing-the-resemblance-of-mathbf-e-1-onto-x-eigenanalysis-of-c">
<h2>Maximizing the resemblance of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> onto <strong>X</strong> = Eigenanalysis of <strong>C</strong>!<a class="headerlink" href="#maximizing-the-resemblance-of-mathbf-e-1-onto-x-eigenanalysis-of-c" title="Permalink to this headline">#</a></h2>
<p>The resemblance of the <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> to the data, <strong>X</strong>, is measured by the <em>inner product</em> of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> with <strong>X</strong> (this is also called the <em>projection</em> of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> onto <strong>X</strong>).</p>
<p>If we want to maximize this resemblance, there are a few steps that we should take:</p>
<ol class="arabic simple">
<li><p>we should square the resemblance to ensure that positive and negative resemblances are counted the same (as in the case of linear regression where we square the errors).</p></li>
<li><p>we should divide the resemblance by <span class="math notranslate nohighlight">\(M\)</span> or <span class="math notranslate nohighlight">\(M-1\)</span> to ensure that the resemblance is independent of the number of observations.</p></li>
<li><p>we should normalize the eigenvector, <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span>, to have unit length to make the resemblance independent of the magnitude of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span>. Otherwise the resemblance can be made arbitrarily large by increasing the magnitude of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span>.</p></li>
</ol>
<p>If one follows these rules, the resemblance of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> to the data turns out to be:</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{M-1}(\mathbf{Xe_1})^2
\]</div>
<p>In order to satisfy matrix multiplication rules, this can be re-written as:</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{M-1} \mathbf{e_1^TX^TXe_1}
\]</div>
<p>This is equivalent to maximizing,</p>
<div class="math notranslate nohighlight">
\[
\mathbf{e_1^TCe_1}
\]</div>
<p>subject to the constraint that <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> is a unit vector.</p>
<p>If we assume the maximum value of this squared resemblance is <span class="math notranslate nohighlight">\(\lambda_1\)</span>,</p>
<div class="math notranslate nohighlight">
\[
\mathbf{e_1^TCe_1} = \lambda_1
\]</div>
<p>we find that the above equation has the same form as the eigenvalue problem we discussed in the previous section. That is, this equation becomes,</p>
<div class="math notranslate nohighlight">
\[
\mathbf{Ce_1} = \lambda_1\mathbf{e_1}
\]</div>
<p>Thus, <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> must be an eigenvector of <strong>C</strong> with corresponding eigenvalue <span class="math notranslate nohighlight">\(\lambda_1\)</span>! Hence, we can find <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> by “eigenanalyzing” <strong>C</strong>.</p>
<section id="key-points">
<h3>Key Points:<a class="headerlink" href="#key-points" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>The 1st eigenvector corresponds to the vector that explains the most variance in <strong>X</strong> and has the largest eigenvalue</p></li>
<li><p>The 2nd eigenvector corresponds to the vector that explains the second most variance in <strong>X</strong> and has the 2nd largest eigenvalue</p></li>
<li><p>The eigenanalysis of the covariance matrix transforms <strong>C</strong> into a different coordinate system where the “new” matrix is diagonal (<span class="math notranslate nohighlight">\(\mathbf{\Lambda}\)</span>).</p></li>
<li><p>In this new coordinate space, all of the variance is along the diagonal since the different vectors are orthogonal. Thus, the fraction of variance explained by the <span class="math notranslate nohighlight">\(j\)</span>th eigenvector is the corresponding eigenvalue <span class="math notranslate nohighlight">\(\lambda_j\)</span> divided by the sum of all of the eigenvalues, that is <span class="math notranslate nohighlight">\(\frac{\lambda_j}{\sum_i \lambda_i}\)</span></p></li>
<li><p>Typically, EOFs are ordered by their corresponding <span class="math notranslate nohighlight">\(\lambda\)</span>, such that EOF 1 explains the largest variance (largest <span class="math notranslate nohighlight">\(\lambda\)</span>) and the last EOF (typically the <span class="math notranslate nohighlight">\(N\)</span>th EOF) has the smallest.</p></li>
</ul>
<p><em>No other linear combination of <span class="math notranslate nohighlight">\(k\)</span> predictors can explain a larger fraction of the variance than the first <span class="math notranslate nohighlight">\(k\)</span> EOF/PC’s!</em></p>
</section>
</section>
<section id="principal-component-time-series-change-of-basis">
<h2>Principal Component Time Series = Change of Basis<a class="headerlink" href="#principal-component-time-series-change-of-basis" title="Permalink to this headline">#</a></h2>
<p>So, we have seen that if <strong>X</strong> is <span class="math notranslate nohighlight">\([M x N]\)</span> where the rows denote different times and the columns different spatial locations, the eigenvectors correspond to the patterns describing the variability. But, as we saw in the Introduction to PCA, we can also generate corresponding principal component time series. How do we go about generating these time series?</p>
<p>The principal component time series, <strong>Z</strong>, are equivalent to mapping <strong>X</strong> into the new vector space spanned by the eigenvectors. We can do this by performing a linear transformation of <strong>X</strong>:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{XE} = \mathbf{Z}
\]</div>
<p><a class="reference internal" href="#pc-ts"><span class="std std-ref">Figure 27</span></a> provides a visual representation of what this looks like for the sea-level pressure anomaly data.</p>
<figure class="align-default" id="pc-ts">
<a class="reference internal image-reference" href="../../_images/pc_ts.png"><img alt="../../_images/pc_ts.png" src="../../_images/pc_ts.png" style="width: 776.0px; height: 375.20000000000005px;" /></a>
<figcaption>
<p><span class="caption-text">Visualizing EOF/PC spatial patterns and time series using daily sea-level pressure (mb) anomalies. <strong>X</strong> is the data matrix and <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> is the eigenvector that explains the largest fraction of the variability in <strong>X</strong>. <span class="math notranslate nohighlight">\(\mathbf{z_1}\)</span> is linear transformation of <strong>X</strong> onto the <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> basis vector.</span><a class="headerlink" href="#pc-ts" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><strong>Z</strong> can also be interpreted as the degree to which a particular day looks like the corresponding eigenvector pattern and has size <span class="math notranslate nohighlight">\([M x 1]\)</span> (the time dimension). So, if we know all the eigenvectors (EOFs) and the corresponding principal component time series (PCs), then we can reconstruct out original data matrix, <strong>X</strong>:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{X} = \mathbf{ZE^T}
\]</div>
</section>
<section id="summary-of-finding-eofs-pcs">
<h2>Summary of finding EOFs/PCs<a class="headerlink" href="#summary-of-finding-eofs-pcs" title="Permalink to this headline">#</a></h2>
<p>For a data matrix <strong>X</strong> with size <span class="math notranslate nohighlight">\([M x N]\)</span> where the rows denote different times and the columns different spatial locations, we can find the EOFs/PCs using the following steps:</p>
<ul class="simple">
<li><p>subtract the mean values along the sampling/time dimension of <strong>X</strong></p></li>
<li><p>unless there are issues with data size and computation time, define <strong>C</strong> along the sampling/time dimension so you are have a covariance matrix with dimensions corresponding to the spatial dimensions <span class="math notranslate nohighlight">\([N x N]\)</span></p></li>
<li><p>eigenanalyze <strong>C</strong> by diagonalizing the matrix</p></li>
<li><p>the first EOF is the eigenvector corresponding to the largest eigenvalue</p></li>
<li><p>to find the PC time series, transform the data onto the set of eigenvectors (PC’s should be the length of your sampling dimension)</p></li>
<li><p>the fraction of variance explained by the <span class="math notranslate nohighlight">\(j\)</span>th EOF/PC pair is <span class="math notranslate nohighlight">\(\frac{\lambda_j}{\sum_i \lambda_i}\)</span></p></li>
</ul>
<p>In the next section, we will take a look at an example and go through the above procedure step-by-step.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "kls2177/Climate-and-Geophysical-Data-Analysis",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters/Week7"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-problem">Setting up the Problem…</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#maximizing-the-resemblance-of-mathbf-e-1-onto-x-eigenanalysis-of-c">Maximizing the resemblance of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> onto <strong>X</strong> = Eigenanalysis of <strong>C</strong>!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-points">Key Points:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principal-component-time-series-change-of-basis">Principal Component Time Series = Change of Basis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-finding-eofs-pcs">Summary of finding EOFs/PCs</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Karen Smith
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2020.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>