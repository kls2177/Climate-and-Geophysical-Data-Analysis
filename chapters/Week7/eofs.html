
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EOFs via Eigenanalysis &#8212; Climate and Geophysical Data Analysis</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://kls2177.github.io/Climate-and-Geophysical-Data-Analysis/chapters/index.html/chapters/Week7/eofs.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="EOFs with Real Data" href="naoeof.html" />
    <link rel="prev" title="Eigenanalysis" href="eig.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://kls2177.github.io/Climate-and-Geophysical-Data-Analysis/chapters/index.html/chapters/Week7/eofs.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="EOFs via Eigenanalysis" />
<meta property="og:description" content="EOFs via Eigenanalysis  In this section, we will discuss why an eigenanalysis of the covariance matrix (PCA or empirical orthogonal functions (EOFs) analysis) i" />
<meta property="og:image"       content="https://kls2177.github.io/Climate-and-Geophysical-Data-Analysis/chapters/index.html/_static/gistemp.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/gistemp.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Climate and Geophysical Data Analysis</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Climate and Geophysical Data Analysis
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week1a/whatarestatsgoodfor.html">
   What are statistics good for?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week1b/descriptivestats.html">
   Descriptive Statistics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week2/hypothesis_testing.html">
   Statistical Hypothesis Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week3/linreg.html">
   Linear Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week4/corr.html">
   Correlation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week5/persistence.html">
   Persistence in Time Series
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week6/filt.html">
   Time Series Analysis
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="pca.html">
   Patterns in Multivariate Data
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Intro_to_PCA.html">
     Introduction to Principal Component Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linalg.html">
     Review of Linear Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eig.html">
     Eigenanalysis
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     EOFs via Eigenanalysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="naoeof.html">
     EOFs with Real Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week8/epilogue.html">
   Epilogue
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/chapters/Week7/eofs.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/kls2177/Climate-and-Geophysical-Data-Analysis/master?urlpath=tree/chapters/Week7/eofs.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/kls2177/Climate-and-Geophysical-Data-Analysis/blob/master/chapters/Week7/eofs.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setting-up-the-problem">
   Setting up the Problem…
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#maximizing-the-resemblance-of-mathbf-e-1-onto-x-eigenanalysis-of-c">
   Maximizing the resemblance of
   <span class="math notranslate nohighlight">
    \(\mathbf{e_1}\)
   </span>
   onto
   <strong>
    X
   </strong>
   = Eigenanalysis of
   <strong>
    C
   </strong>
   !
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#key-points">
     Key Points:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#principal-component-time-series-change-of-basis">
   Principal Component Time Series = Change of Basis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary-of-finding-eofs-pcs">
   Summary of finding EOFs/PCs
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="eofs-via-eigenanalysis">
<h1>EOFs via Eigenanalysis<a class="headerlink" href="#eofs-via-eigenanalysis" title="Permalink to this headline">¶</a></h1>
<p>In this section, we will discuss why an eigenanalysis of the covariance matrix (PCA or empirical orthogonal functions (EOFs) analysis) is a sensible approach to identifying patterns of variability in climate and geophysical data. There are many other approaches, but in this course, we will restrict ourselfves to PCA.</p>
<p>First, a few notes on terminology:</p>
<ul class="simple">
<li><p>EOF stands for <em>Empirical Orthogonal Functions</em></p></li>
<li><p>PCA stands for <em>Principal Component Analysis</em></p></li>
<li><p>EOF analysis and PCA are practically the same thing</p></li>
<li><p>PCA is the more generally used term, and just implies converting a matrix into sets of linearly uncorrelated variables, called principle components.</p></li>
<li><p>EOF analysis normally refers to finding the principle components that maximize the variance explained (i.e., a subset of all PC’s)</p></li>
</ul>
<div class="section" id="setting-up-the-problem">
<h2>Setting up the Problem…<a class="headerlink" href="#setting-up-the-problem" title="Permalink to this headline">¶</a></h2>
<p>Say we have a data matrix <strong>X</strong> which is <span class="math notranslate nohighlight">\([M x N]\)</span>. For now, let the rows denote different times and the columns different spatial locations (although this is not required for the actual application).</p>
<p>The goal of EOF analysis is to decompose <strong>X</strong> into a set of spatial patterns, i.e, orthogonal eigenvectors, <span class="math notranslate nohighlight">\(\mathbf{e_i}\)</span>’s, that explain the most variance of <strong>X</strong>. In other words, we want to maximize the resemblance of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> (dimension <span class="math notranslate nohighlight">\([N x 1]\)</span>, the spatial dimension) to the data, that is, find the <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> that explains the most variance.</p>
<p><a class="reference internal" href="#eofs"><span class="std std-ref">Figure 26</span></a> provides a visualization of what we are trying to accomplish. <strong>X</strong> is a data matrix consisting of sea-level pressure (SLP) in mb at <span class="math notranslate nohighlight">\(N\)</span> points in space and <span class="math notranslate nohighlight">\(M\)</span> points in time.</p>
<div class="figure align-default" id="eofs">
<a class="reference internal image-reference" href="../../_images/eofs.png"><img alt="../../_images/eofs.png" src="../../_images/eofs.png" style="width: 703.0px; height: 549.0px;" /></a>
<p class="caption"><span class="caption-number">Fig. 26 </span><span class="caption-text">Visualizing EOF/PC spatial patterns using daily sea-level pressure (mb) anomalies. <strong>X</strong> is the data matrix and <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> is the eigenvector that explains the largest fraction of the variability in <strong>X</strong>.</span><a class="headerlink" href="#eofs" title="Permalink to this image">¶</a></p>
</div>
<p>The first eigenvector, <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span>, shows the pattern that explains the most variance in <strong>X</strong>. Note that just like the unit eigenvectors of 2-D or 3-D space, where <span class="math notranslate nohighlight">\(\mathbf{e_1} = (1,0)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{e_1} = (-1,0)\)</span> are both legitimate eigenvectors, <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> describing the variance of <strong>X</strong> can look like the pattern in <a class="reference internal" href="#eofs"><span class="std std-ref">Figure 26</span></a> or it can look like -1 <em>x</em> this pattern.</p>
</div>
<div class="section" id="maximizing-the-resemblance-of-mathbf-e-1-onto-x-eigenanalysis-of-c">
<h2>Maximizing the resemblance of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> onto <strong>X</strong> = Eigenanalysis of <strong>C</strong>!<a class="headerlink" href="#maximizing-the-resemblance-of-mathbf-e-1-onto-x-eigenanalysis-of-c" title="Permalink to this headline">¶</a></h2>
<p>The resemblance of the <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> to the data, <strong>X</strong>, is measured by the <em>inner product</em> of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> with <strong>X</strong> (this is also called the <em>projection</em> of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> onto <strong>X</strong>).</p>
<p>If we want to maximize this resemblance, there are a few steps that we should take:</p>
<ol class="simple">
<li><p>we should square the resemblance to ensure that positive and negative resemblances are counted the same (as in the case of linear regression where we square the errors).</p></li>
<li><p>we should divide the resemblance by <span class="math notranslate nohighlight">\(M\)</span> or <span class="math notranslate nohighlight">\(M-1\)</span> to ensure that the resemblance is independent of the number of observations.</p></li>
<li><p>we should normalize the eigenvector, <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span>, to have unit length to make the resemblance independent of the magnitude of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span>. Otherwise the resemblance can be made arbitrarily large by increasing the magnitude of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span>.</p></li>
</ol>
<p>If one follows these rules, the resemblance of <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> to the data turns out to be:</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{M-1}(\mathbf{Xe_1})^2
\]</div>
<p>In order to satisfy matrix multiplication rules, this can be re-written as:</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{M-1} \mathbf{e_1^TX^TXe_1}
\]</div>
<p>This is equivalent to maximizing,</p>
<div class="math notranslate nohighlight">
\[
\mathbf{e_1^TCe_1}
\]</div>
<p>subject to the constraint that <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> is a unit vector.</p>
<p>If we assume the maximum value of this squared resemblance is <span class="math notranslate nohighlight">\(\lambda_1\)</span>,</p>
<div class="math notranslate nohighlight">
\[
\mathbf{e_1^TCe_1} = \lambda_1
\]</div>
<p>we find that the above equation has the same form as the eigenvalue problem we discussed in the previous section. That is, this equation becomes,</p>
<div class="math notranslate nohighlight">
\[
\mathbf{Ce_1} = \lambda_1\mathbf{e_1}
\]</div>
<p>Thus, <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> must be an eigenvector of <strong>C</strong> with corresponding eigenvalue <span class="math notranslate nohighlight">\(\lambda_1\)</span>! Hence, we can find <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> by “eigenanalyzing” <strong>C</strong>.</p>
<div class="section" id="key-points">
<h3>Key Points:<a class="headerlink" href="#key-points" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The 1st eigenvector corresponds to the vector that explains the most variance in <strong>X</strong> and has the largest eigenvalue</p></li>
<li><p>The 2nd eigenvector corresponds to the vector that explains the second most variance in <strong>X</strong> and has the 2nd largest eigenvalue</p></li>
<li><p>The eigenanalysis of the covariance matrix transforms <strong>C</strong> into a different coordinate system where the “new” matrix is diagonal (<span class="math notranslate nohighlight">\(\mathbf{\Lambda}\)</span>).</p></li>
<li><p>In this new coordinate space, all of the variance is along the diagonal since the different vectors are orthogonal. Thus, the fraction of variance explained by the <span class="math notranslate nohighlight">\(j\)</span>th eigenvector is the corresponding eigenvalue <span class="math notranslate nohighlight">\(\lambda_j\)</span> divided by the sum of all of the eigenvalues, that is <span class="math notranslate nohighlight">\(\frac{\lambda_j}{\sum_i \lambda_i}\)</span></p></li>
<li><p>Typically, EOFs are ordered by their corresponding <span class="math notranslate nohighlight">\(\lambda\)</span>, such that EOF 1 explains the largest variance (largest <span class="math notranslate nohighlight">\(\lambda\)</span>) and the last EOF (typically the <span class="math notranslate nohighlight">\(N\)</span>th EOF) has the smallest.</p></li>
</ul>
<p><em>No other linear combination of <span class="math notranslate nohighlight">\(k\)</span> predictors can explain a larger fraction of the variance than the first <span class="math notranslate nohighlight">\(k\)</span> EOF/PC’s!</em></p>
</div>
</div>
<div class="section" id="principal-component-time-series-change-of-basis">
<h2>Principal Component Time Series = Change of Basis<a class="headerlink" href="#principal-component-time-series-change-of-basis" title="Permalink to this headline">¶</a></h2>
<p>So, we have seen that if <strong>X</strong> is <span class="math notranslate nohighlight">\([M x N]\)</span> where the rows denote different times and the columns different spatial locations, the eigenvectors correspond to the patterns describing the variability. But, as we saw in the Introduction to PCA, we can also generate corresponding principal component time series. How do we go about generating these time series?</p>
<p>The principal component time series, <strong>Z</strong>, are equivalent to mapping <strong>X</strong> into the new vector space spanned by the eigenvectors. We can do this by performing a linear transformation of <strong>X</strong>:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{XE} = \mathbf{Z}
\]</div>
<p><a class="reference internal" href="#pc-ts"><span class="std std-ref">Figure 27</span></a> provides a visual representation of what this looks like for the sea-level pressure anomaly data.</p>
<div class="figure align-default" id="pc-ts">
<a class="reference internal image-reference" href="../../_images/pc_ts.png"><img alt="../../_images/pc_ts.png" src="../../_images/pc_ts.png" style="width: 776.0px; height: 375.20000000000005px;" /></a>
<p class="caption"><span class="caption-number">Fig. 27 </span><span class="caption-text">Visualizing EOF/PC spatial patterns and time series using daily sea-level pressure (mb) anomalies. <strong>X</strong> is the data matrix and <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> is the eigenvector that explains the largest fraction of the variability in <strong>X</strong>. <span class="math notranslate nohighlight">\(\mathbf{z_1}\)</span> is linear transformation of <strong>X</strong> onto the <span class="math notranslate nohighlight">\(\mathbf{e_1}\)</span> basis vector.</span><a class="headerlink" href="#pc-ts" title="Permalink to this image">¶</a></p>
</div>
<p><strong>Z</strong> can also be interpreted as the degree to which a particular day looks like the corresponding eigenvector pattern and has size <span class="math notranslate nohighlight">\([M x 1]\)</span> (the time dimension). So, if we know all the eigenvectors (EOFs) and the corresponding principal component time series (PCs), then we can reconstruct out original data matrix, <strong>X</strong>:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{X} = \mathbf{ZE^T}
\]</div>
</div>
<div class="section" id="summary-of-finding-eofs-pcs">
<h2>Summary of finding EOFs/PCs<a class="headerlink" href="#summary-of-finding-eofs-pcs" title="Permalink to this headline">¶</a></h2>
<p>For a data matrix <strong>X</strong> with size <span class="math notranslate nohighlight">\([M x N]\)</span> where the rows denote different times and the columns different spatial locations, we can find the EOFs/PCs using the following steps:</p>
<ul class="simple">
<li><p>subtract the mean values along the sampling/time dimension of <strong>X</strong></p></li>
<li><p>unless there are issues with data size and computation time, define <strong>C</strong> along the sampling/time dimension so you are have a covariance matrix with dimensions corresponding to the spatial dimensions <span class="math notranslate nohighlight">\([N x N]\)</span></p></li>
<li><p>eigenanalyze <strong>C</strong> by diagonalizing the matrix</p></li>
<li><p>the first EOF is the eigenvector corresponding to the largest eigenvalue</p></li>
<li><p>to find the PC time series, transform the data onto the set of eigenvectors (PC’s should be the length of your sampling dimension)</p></li>
<li><p>the fraction of variance explained by the <span class="math notranslate nohighlight">\(j\)</span>th EOF/PC pair is <span class="math notranslate nohighlight">\(\frac{\lambda_j}{\sum_i \lambda_i}\)</span></p></li>
</ul>
<p>In the next section, we will take a look at an example and go through the above procedure step-by-step.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "kls2177/Climate-and-Geophysical-Data-Analysis",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/Week7"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="eig.html" title="previous page">Eigenanalysis</a>
    <a class='right-next' id="next-link" href="naoeof.html" title="next page">EOFs with Real Data</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Karen Smith<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>