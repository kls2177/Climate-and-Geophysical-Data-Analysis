

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Filtering in the Frequency Domain: Discrete Fourier Transform &#8212; Climate and Geophysical Data Analysis</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/Week6/filtering_in_freq1';</script>
    <link rel="canonical" href="https://kls2177.github.io/Climate-and-Geophysical-Data-Analysis/chapters/index.html/chapters/Week6/filtering_in_freq1.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/gistemp.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/gistemp.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Climate and Geophysical Data Analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/intro.html">Introduction</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/aboutthisbook.html">About this book</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/howtousethisbook.html">How to use this book</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week1a/whatarestatsgoodfor.html">What are statistics good for?</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week1a/goodpractice.html">Statistics is the grammar of science…</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week1a/pitfalls.html">Lies, damned lies and statistics…</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/kls2177/Climate-and-Geophysical-Data-Analysis/master?urlpath=tree/chapters/Week6/filtering_in_freq1.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chapters/Week6/filtering_in_freq1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Filtering in the Frequency Domain: Discrete Fourier Transform</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-problem">Setting up the problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-few-things-to-note">A few things to note…</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fourier-decomposition">Fourier Decomposition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variance-explained-discrete-fourier-transform">Variance Explained: Discrete Fourier Transform!</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="filtering-in-the-frequency-domain-discrete-fourier-transform">
<h1>Filtering in the Frequency Domain: Discrete Fourier Transform<a class="headerlink" href="#filtering-in-the-frequency-domain-discrete-fourier-transform" title="Permalink to this headline">#</a></h1>
<p>In the previous sections, we learned several methods of filtering and smoothing data in the time domain. A much more powerful way of filtering data is in the <em>frequency</em> domain.</p>
<p>To work in the frequency domain, we will build on the concept of Fourier series and introduce the <strong>Fourier Transform</strong>. The Fourier Transform allows us to determine the time scales of variability of a time series by decomposing the time series into its harmonic components. We are going to explore how this is done by using the concept of <a class="reference external" href="https://kls2177.github.io/Climate-and-Geophysical-Data-Analysis/chapters/Week3/basics_linreg.html">regression</a>, i.e., thinking of a Fourier series as a fitted time series where the predictors are the sines and cosines.</p>
<p>Just like linear regression, we are working towards an expression of the <em>fraction of variance explained</em> by the fits with the different harmonic components.</p>
<p>Let’s begin.</p>
<section id="setting-up-the-problem">
<h2>Setting up the problem<a class="headerlink" href="#setting-up-the-problem" title="Permalink to this headline">#</a></h2>
<p>In the case of a time series, <span class="math notranslate nohighlight">\(y(t)\)</span> consisting of <em>discrete</em>, evenly spaced data:</p>
<p>Consider the domain 0 <span class="math notranslate nohighlight">\(\leq t \leq T\)</span>, where 0 and <span class="math notranslate nohighlight">\(T\)</span> coincide with data points 1 and <span class="math notranslate nohighlight">\(N\)</span>+1, and <span class="math notranslate nohighlight">\(N\)</span> is an even number. Recall that we can write <span class="math notranslate nohighlight">\(y(t)\)</span> as,</p>
<div class="math notranslate nohighlight">
\[
y(t) = A_0 + \sum_{k=1}^{N/2} A_k\text{cos}(2\pi k \frac{t}{T}) +  \sum_{k=1}^{N/2} B_k\text{sin}(2\pi k \frac{t}{T})
\]</div>
<p>Thus, we need to solve for the intercept, <span class="math notranslate nohighlight">\(A_0\)</span>, and the regression coefficients, <span class="math notranslate nohighlight">\(A_k\)</span> and <span class="math notranslate nohighlight">\(B_k\)</span>.</p>
<section id="a-few-things-to-note">
<h3>A few things to note…<a class="headerlink" href="#a-few-things-to-note" title="Permalink to this headline">#</a></h3>
<ol class="arabic simple">
<li><p>the average of each sine/cosine function on the interval from <span class="math notranslate nohighlight">\(t_1\)</span> = 0 to <span class="math notranslate nohighlight">\(t_N+1\)</span> = <span class="math notranslate nohighlight">\(T\)</span> is equal to 0, so, <span class="math notranslate nohighlight">\(A_0\)</span> = <span class="math notranslate nohighlight">\(\overline{y}\)</span>.</p></li>
<li><p>the harmonic functions (the predictors) are mutually orthogonal on the interval, i.e., the correlation (<span class="math notranslate nohighlight">\(\rho\)</span>) between sine and cosine functions is zero and the correlation between sine or cosine functions with different integer wavenumbers is also zero.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\rho(\text{sin(x)},\text{cos(x)}) &amp; = 0\\
\rho(\text{cos(x)},\text{cos(2x)}) &amp; = 0
\end{align}
\end{split}\]</div>
<ol class="arabic simple" start="3">
<li><p>the regression coefficients of <span class="math notranslate nohighlight">\(y(t)\)</span> regressed onto the harmonic function can be written as,</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
A_k, B_k = \frac{\overline{x_k^{\prime}y^{\prime}}}{\overline{x_k^{\prime 2}}}
\]</div>
<p>where,</p>
<div class="math notranslate nohighlight">
\[
x_k = \text{cos}(2\pi k \frac{t}{T})
\]</div>
<p>for <span class="math notranslate nohighlight">\(A_k\)</span> and</p>
<div class="math notranslate nohighlight">
\[
x_k = \text{sin}(2\pi k \frac{t}{T})
\]</div>
<p>for <span class="math notranslate nohighlight">\(B_k\)</span>.</p>
<ol class="arabic simple" start="4">
<li><p>the harmonic functions all have variance, <span class="math notranslate nohighlight">\(\overline{x_k^{\prime 2}} = \frac{1}{2}\)</span>, except for <span class="math notranslate nohighlight">\(k = N\)</span>/2, when the variance of the cosine term is 1 and the variance of the sine term is 0.</p></li>
</ol>
<p>From the above, the solutions for each predictor, <span class="math notranslate nohighlight">\(A_k\)</span> and <span class="math notranslate nohighlight">\(B_k\)</span> reduce to:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
A_k &amp; = 2\overline{\text{cos}(2\pi k \frac{t}{T})y^{\prime}}\\
B_k &amp; = 2\overline{\text{sin}(2\pi k \frac{t}{T})y^{\prime}}\\
A_{N/2} &amp; = \overline{\text{cos}(2\pi k \frac{t}{T})y^{\prime}}\\
B_{N/2} &amp; = 0
\end{align}
\end{split}\]</div>
<p>where the 2 in front of the coefficients comes from the fact that <span class="math notranslate nohighlight">\(\overline{x_k^{\prime 2}} = \frac{1}{2}\)</span>.</p>
<p>Thus, <span class="math notranslate nohighlight">\(y(t)\)</span> can be written as follows,</p>
<div class="math notranslate nohighlight">
\[
y(t) = \overline{y} + \sum_{k=1}^{N/2-1}\left( A_k\text{cos}(2\pi k \frac{t}{T}) +  B_k\text{sin}(2\pi k \frac{t}{T})\right) + A_{N/2}\text{cos}(2\pi k \frac{t}{T})
\]</div>
<p>For simplicity, we can convert the above into phase-amplitude form:</p>
<div class="math notranslate nohighlight">
\[
y(t) = \overline{y} + \sum_{k=1}^{N/2}C_k\text{cos}(2\pi k \frac{t}{T} - \phi_k)
\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[
C_k^2 = A_k^2 + B_k^2
\]</div>
<p>This follows from the pythagorean theorem, with <span class="math notranslate nohighlight">\(A_k\)</span> along the <span class="math notranslate nohighlight">\(x\)</span>-axis and <span class="math notranslate nohighlight">\(B_k\)</span> along the <span class="math notranslate nohighlight">\(y\)</span> and the angle <span class="math notranslate nohighlight">\(\phi_k\)</span> representing the angle between the two. Here is a little video illustrating this <a class="reference external" href="https://www.youtube.com/watch?v=6zfefPUgSSY">conversion</a> intuitively and here two others (<a class="reference external" href="https://www.youtube.com/watch?v=VTo8slkc11M">here</a> and <a class="reference external" href="https://www.youtube.com/watch?v=fNuxiNGjDpY">here</a>) going through the proof.</p>
</section>
</section>
<section id="fourier-decomposition">
<h2>Fourier Decomposition<a class="headerlink" href="#fourier-decomposition" title="Permalink to this headline">#</a></h2>
<p>Before we move ahead to the Fourier Transform, let’s just take a look at how we can generate Fourier components of time series using the above expressions. For this, we will use the <a class="reference external" href="https://github.com/kls2177/ccia_files/blob/master/NINO34_monthly_Jan1958_Dec2019.csv?raw=true">El Niño Southern Oscillation (ENSO) index</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load packages</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">st</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span> <span class="c1">#set default font size and weight for plots</span>
</pre></div>
</div>
</div>
</div>
<p>We will load in the NINO3.4 ENSO index from Jan. 1958 - Dec. 2019.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load data</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;NINO34_monthly_Jan1958_Dec2019.csv&#39;</span>
<span class="n">ENSO</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">))</span> 

<span class="c1"># let&#39;s also reshape ENSO into one long time series</span>
<span class="n">Ny</span><span class="p">,</span><span class="n">Nm</span> <span class="o">=</span> <span class="n">ENSO</span><span class="o">.</span><span class="n">shape</span>
<span class="n">ENSO</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ENSO</span><span class="p">,</span><span class="n">Ny</span><span class="o">*</span><span class="n">Nm</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>What does this time series look like? Can we see different time scales of variability in the data?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot ENSO time series</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ENSO</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ENSO Time Series (1958-2019)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Months&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ENSO</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e683c87733979f514a99802944bb3320ff30bf35f0c1e595acc9e3ece1cb94bc.png" src="../../_images/e683c87733979f514a99802944bb3320ff30bf35f0c1e595acc9e3ece1cb94bc.png" />
</div>
</div>
<p>Let’s construct the component of this time series representing the 5-year frequency using harmonics. We will start by writing down our parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s start with some parameters</span>
<span class="c1"># we are using monthly data, so the 5-year frequency and wavenumber are:</span>

<span class="n">yr</span> <span class="o">=</span> <span class="mf">5.166666667</span> <span class="c1"># note that we are using not exactly 5 years, such that k is an integer</span>

<span class="c1"># frequency</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">yr</span><span class="p">)</span>

<span class="c1"># period</span>
<span class="n">T</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ENSO</span><span class="p">))</span>

<span class="c1"># wavenumber</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">f</span><span class="o">*</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The wavenumber is&quot;</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>

<span class="c1"># time variable</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ENSO</span><span class="p">))</span>

<span class="c1"># argument for sine and cosine functions</span>
<span class="n">theta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">time</span><span class="o">*</span><span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The wavenumber is 11.999999999225807
</pre></div>
</div>
</div>
</div>
<p>Now, let’s write down the sine and cosine functions using the <code class="docutils literal notranslate"><span class="pre">theta</span></code> argument above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># do fourier decomposition (calculate sines and cosines for a given frequency)</span>
<span class="n">coskd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">sinkd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now write out the harmonic coefficients, <span class="math notranslate nohighlight">\(A_k\)</span> and <span class="math notranslate nohighlight">\(B_k\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Calculate the coefficients for the harmonics</span>
<span class="n">ak</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">coskd</span> <span class="o">*</span> <span class="n">ENSO</span><span class="p">)</span>
<span class="n">bk</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sinkd</span> <span class="o">*</span> <span class="n">ENSO</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For convenience, we will convert to the amplitude-phase format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert to amplitude and phase format</span>
<span class="n">ck</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ak</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">bk</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">lk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">bk</span><span class="p">,</span><span class="n">ak</span><span class="p">)</span><span class="o">/</span><span class="n">k</span>
</pre></div>
</div>
</div>
</div>
<p>Thus, the 5-year frequency component of the ENSO time series is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># construct the 5-year frequency component of the ENSO time series</span>
<span class="n">ENSO_5yr</span> <span class="o">=</span> <span class="n">ck</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span> <span class="o">-</span> <span class="n">lk</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can plot the original ENSO time series and the 5-year frequency component on the same graph to see how much of the variability we have captured.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot original ENSO time series and 5-year component</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ENSO</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ENSO_5yr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;5-year component&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ENSO Time Series (1958-2019)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Months&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ENSO</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d693535214f564b6f0e430aa63227575d01f5f1d0c1f570e1bc612c54ec3c917.png" src="../../_images/d693535214f564b6f0e430aa63227575d01f5f1d0c1f570e1bc612c54ec3c917.png" />
</div>
</div>
</section>
<section id="variance-explained-discrete-fourier-transform">
<h2>Variance Explained: Discrete Fourier Transform!<a class="headerlink" href="#variance-explained-discrete-fourier-transform" title="Permalink to this headline">#</a></h2>
<p>Back to examining <span class="math notranslate nohighlight">\(y(t)\)</span> regressed on the harmonic components. We can express the <em>fraction of variance explained</em> by each harmonic component in the same way that we did for linear regression. Specifically, the fraction of variance explained by wavenumber, <span class="math notranslate nohighlight">\(k\)</span>, is,</p>
<div class="math notranslate nohighlight">
\[
R_k^2 = \frac{(\overline{x_k^{\prime}y^{\prime}})^2}{\overline{x_k^{\prime 2}}\overline{y^{\prime 2}}}
\]</div>
<p>This should look very similar to the <em>coefficient of determination</em> for linear regression, but now we can write down an <span class="math notranslate nohighlight">\(R\)</span>-squared for each wavenumber.</p>
<p>Noticing that much of this expression looks like the expressions for <span class="math notranslate nohighlight">\(A_k\)</span> and <span class="math notranslate nohighlight">\(B_k\)</span>, we can re-write the above as,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
R_k^2 &amp;= \frac{A_k^2}{2\overline{y^{\prime 2}}} \quad \text{for the cosine functions}\\
R_k^2 &amp;= \frac{B_k^2}{2\overline{y^{\prime 2}}} \quad \text{for the sine functions}\\
R_k^2 &amp;= \frac{A_{N/2}^2}{\overline{y^{\prime 2}}} \quad \text{for the special case of $k=N/2$}
\end{align}
\end{split}\]</div>
<p>This is basically what we want in order to determine how much of the variance in <span class="math notranslate nohighlight">\(y(t)\)</span> comes from different harmonic components. Thus, the fraction of variance explained by each harmonic pair (sine + cosine) is,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
R_k^2 &amp;= \frac{A_k^2 + B_k^2}{2\overline{y^{\prime 2}}}\\
&amp; = \frac{C_k^2}{2\overline{y^{\prime 2}}}
\end{align}
\end{split}\]</div>
<p>We can approximate the variance of <span class="math notranslate nohighlight">\(y(t)\)</span> as <span class="math notranslate nohighlight">\(\sum_{k=1}^{N/2}\frac{C_k^2}{2}\)</span> such that,</p>
<div class="math notranslate nohighlight">
\[
R_k^2 = \frac{C_k^2}{\sum_{k=1}^{N/2}C_k^2}
\]</div>
<p>We have just found the <strong>Discrete Fourier Transform</strong>! A plot of <span class="math notranslate nohighlight">\(\frac{C_k^2}{\sum_{k=1}^{N/2}C_k^2}\)</span> versus <span class="math notranslate nohighlight">\(k\)</span> or <span class="math notranslate nohighlight">\(f\)</span> is the <em>discrete power spectrum</em> of <span class="math notranslate nohighlight">\(y(t)\)</span>, where we use the word <em>power</em> and <em>variance</em> interchangeably. <a class="reference internal" href="#dft"><span class="std std-ref">Figure 21</span></a> shows discrete Fourier Transforms of a sine wave and a square wave.</p>
<figure class="align-default" id="dft">
<a class="reference internal image-reference" href="../../_images/DFTs.png"><img alt="../../_images/DFTs.png" src="../../_images/DFTs.png" style="width: 806.4000000000001px; height: 288.0px;" /></a>
<figcaption>
<p><span class="caption-text">Discrete Fourier Transforms (DFT) of (a) a sine wave (k = 4) and (b) a square wave.</span><a class="headerlink" href="#dft" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Now, let’s take a look at the DFT of the ENSO time series. We will loop over all the possible wavenumbers from <span class="math notranslate nohighlight">\(k\)</span> = 1 to <span class="math notranslate nohighlight">\(k\)</span> = <span class="math notranslate nohighlight">\(N\)</span>/2 and compute the corresponding fraction of variance expained.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute variance as a function of k</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ENSO</span><span class="p">))</span>
<span class="n">k_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ENSO</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ck2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k_all</span><span class="p">:</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ENSO</span><span class="p">))</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">time</span><span class="o">*</span><span class="n">k</span><span class="o">/</span><span class="n">T</span>
    
    <span class="n">coskd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">sinkd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    
    <span class="n">ak</span> <span class="o">=</span> <span class="n">ENSO</span><span class="o">*</span><span class="n">coskd</span>
    <span class="n">bk</span> <span class="o">=</span> <span class="n">ENSO</span><span class="o">*</span><span class="n">sinkd</span>

    <span class="n">ak_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ak</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
    <span class="n">bk_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bk</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
    
    <span class="c1">#Use the Pythagorean Theorem to convert to amplitude and phase format</span>
    <span class="n">ck2</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ak_mean</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">bk_mean</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ck2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ck2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s check that the variance of the ENSO time series is roughly approximated by <span class="math notranslate nohighlight">\(\sum_{k=1}^{N/2}\frac{C_k^2}{2}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compare variance of ENSO with total variance of harmonic components</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ENSO</span><span class="p">),</span><span class="mi">5</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ck2</span><span class="p">),</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6886 0.68873
</pre></div>
</div>
</div>
</div>
<p>Pretty close - great! Now, let’s plot the fraction of variance explained, sometimes called the <em>normalized power</em>, as a function of wavenumber, <span class="math notranslate nohighlight">\(k\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot discrete power spectrum</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">k_all</span><span class="p">,</span><span class="n">ck2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ck2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized Power&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Wavenumber&#39;)
</pre></div>
</div>
<img alt="../../_images/39c3775bbf2dfab5f95b8fca03a0035191fac5392970857e83105f19dc840708.png" src="../../_images/39c3775bbf2dfab5f95b8fca03a0035191fac5392970857e83105f19dc840708.png" />
</div>
</div>
<p>Most of the power is in the low frequencies. Let’s see which frequencies these are:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute frequencies that correspond to first 62 wavenumbers</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">k_all</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">62</span><span class="p">]</span><span class="o">/</span><span class="n">T</span>

<span class="c1"># print in terms of years</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">f</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[62.         31.         20.66666667 15.5        12.4        10.33333333
  8.85714286  7.75        6.88888889  6.2         5.63636364  5.16666667
  4.76923077  4.42857143  4.13333333  3.875       3.64705882  3.44444444
  3.26315789  3.1         2.95238095  2.81818182  2.69565217  2.58333333
  2.48        2.38461538  2.2962963   2.21428571  2.13793103  2.06666667
  2.          1.9375      1.87878788  1.82352941  1.77142857  1.72222222
  1.67567568  1.63157895  1.58974359  1.55        1.51219512  1.47619048
  1.44186047  1.40909091  1.37777778  1.34782609  1.31914894  1.29166667
  1.26530612  1.24        1.21568627  1.19230769  1.16981132  1.14814815
  1.12727273  1.10714286  1.0877193   1.06896552  1.05084746  1.03333333
  1.01639344  1.        ]
</pre></div>
</div>
</div>
</div>
<p>This is consistent with what we know about ENSO - it is a low-frequency oscillation with the majority of the power in the 3-7 year range.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "kls2177/Climate-and-Geophysical-Data-Analysis",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters/Week6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-problem">Setting up the problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-few-things-to-note">A few things to note…</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fourier-decomposition">Fourier Decomposition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variance-explained-discrete-fourier-transform">Variance Explained: Discrete Fourier Transform!</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Karen Smith
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>