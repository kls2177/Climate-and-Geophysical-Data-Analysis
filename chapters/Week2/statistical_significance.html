

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Estimating Statistical Significance with a z-test &#8212; Climate and Geophysical Data Analysis</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/Week2/statistical_significance';</script>
    <link rel="canonical" href="https://kls2177.github.io/Climate-and-Geophysical-Data-Analysis/chapters/index.html/chapters/Week2/statistical_significance.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/gistemp.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/gistemp.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Climate and Geophysical Data Analysis
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/intro.html">Introduction</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/aboutthisbook.html">About this book</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/howtousethisbook.html">How to use this book</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week1a/whatarestatsgoodfor.html">What are statistics good for?</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week1a/goodpractice.html">Statistics is the grammar of science…</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week1a/pitfalls.html">Lies, damned lies and statistics…</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/kls2177/Climate-and-Geophysical-Data-Analysis/master?urlpath=tree/chapters/Week2/statistical_significance.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chapters/Week2/statistical_significance.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Estimating Statistical Significance with a z-test</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-testing-revisited">Hypothesis Testing Revisited</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#terminology">Terminology</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#five-simple-steps">Five Simple Steps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#errors-in-hypothesis-testing">Errors in Hypothesis Testing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals">Confidence Intervals</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="estimating-statistical-significance-with-a-z-test">
<h1>Estimating Statistical Significance with a <em>z</em>-test<a class="headerlink" href="#estimating-statistical-significance-with-a-z-test" title="Permalink to this headline">#</a></h1>
<p>So, how do we test whether the mean of the sample is different from the mean of the population? We can use the z-statistic!</p>
<p>Again, recall that the <span class="math notranslate nohighlight">\(z\)</span>-statistic is defined as,</p>
<div class="math notranslate nohighlight">
\[
z = \frac{x - \mu}{\sigma}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> is the population mean and <span class="math notranslate nohighlight">\(\sigma\)</span> is the population standard deviation and <span class="math notranslate nohighlight">\(x\)</span> is normally distributed.</p>
<p>Now, we want to assess the probability of <span class="math notranslate nohighlight">\(\overline{x}\)</span>, not <span class="math notranslate nohighlight">\(x\)</span>. So, we replace <span class="math notranslate nohighlight">\(\mu\)</span> with the population mean of the <span class="math notranslate nohighlight">\(\overline{x}\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> with the population standard deviation of <span class="math notranslate nohighlight">\(\overline{x}\)</span>.</p>
<p>Note that,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\mu_{\overline{x}} &amp;= \mu\\
\sigma_{\overline{x}} &amp;= \frac{\sigma}{\sqrt{N}}
\end{align}
\end{split}\]</div>
<p>Plugging these in leads to,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
z &amp;= \frac{\overline{x} - \mu}{\sigma_{\overline{x}}}\\
&amp;= \frac{\overline{x} - \mu}{\frac{\sigma}{\sqrt{N}}}
\end{align}
\end{split}\]</div>
<p>The z-statistic is now the number of standard errors that the sample mean deviates from the population mean.</p>
<p>We can easily manipulate the above equation for the <span class="math notranslate nohighlight">\(z\)</span>-statistic to obtain an equation for the difference of two means, <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> (as opposed to the difference between a sample mean and the population), where <span class="math notranslate nohighlight">\(\sigma_1\)</span> can be different from <span class="math notranslate nohighlight">\(\sigma_2\)</span>:</p>
<div class="math notranslate nohighlight">
\[
z = \frac{(\overline{x_1} - \overline{x_2}) - \Delta_{1,2}}{\sqrt{\frac{\sigma_1^2}{N_1} + \frac{\sigma_2^2}{N_2}}}
\]</div>
<p><span class="math notranslate nohighlight">\(\Delta_{1,2}\)</span> is the null hypothesized difference between the two means, which is typically zero in practice.</p>
<p>Let’s revisit our ENSO example to apply the above to real data. First, we will look at an example using the <span class="math notranslate nohighlight">\(z\)</span>-statistic for a single value of our ENSO index and then we will look at an example using the <span class="math notranslate nohighlight">\(z\)</span>-statistic for a sample of our ENSO index.</p>
<div class="tip admonition">
<p class="admonition-title">Question #1</p>
<p>What is the probability that December 2013 had an ENSO index of -0.50 or less? Assume that the ENSO index is standard normal.</p>
</div>
<p>To answer this, we will simply use our <span class="math notranslate nohighlight">\(z\)</span>-table as we did two sections ago.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">st</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">#Question #1</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3085
</pre></div>
</div>
</div>
</div>
<p>Thus, there is a ~31% likelihood that the December 2013 ENSO index could have a value of -0.5 or less.</p>
<div class="tip admonition">
<p class="admonition-title">Question #2</p>
<p>What is the probability that the average 2003-2013 monthly ENSO index was -0.50 or less (assuming that ENSO dynamics have not changed)? Assume that the ENSO index is standard normal.</p>
</div>
<p>Before we answer this, let’s reframe the question in terms of a null and alternative hypothesis. What is our null hypothesis? In this case our null hypothesis would be that the sample mean ENSO index of -0.5 is the same as the population mean, which is zero in this case (ENSO is standard normal). The alternative hypothesis is that the sample mean and population mean are different.</p>
<p>We will use the <span class="math notranslate nohighlight">\(z\)</span>-statistic to answer this question, in other words, we will perform a <strong>z-test</strong>.</p>
<p>First, how big is our sample? We have a sample of ENSO indices which is 10 years x 12 months per year in size, giving <span class="math notranslate nohighlight">\(N\)</span> = 120.</p>
<p>Next, let’s write down what we know:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\overline{x} &amp;= -0.5\\
N &amp;= 120\\
\mu &amp; = 0\\
\sigma &amp; = 1
\end{align}
\end{split}\]</div>
<p>Plugging these into our <span class="math notranslate nohighlight">\(z\)</span>-statistic equation, we get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
z &amp;= \frac{\overline{x} - \mu}{\frac{\sigma}{\sqrt{N}}}\\
&amp; = \frac{-0.5 - 0}{\frac{1}{\sqrt{120}}}\\
&amp; = -5.48
\end{align}
\end{split}\]</div>
<p>We can now look up this value for <span class="math notranslate nohighlight">\(z\)</span> in our <span class="math notranslate nohighlight">\(z\)</span>-table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Question #2</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">5.48</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.126629179795902e-08
</pre></div>
</div>
</div>
</div>
<p>This is a <em>very</em> small value, indicating that this is a very rare event. We can conclude that the sample mean ENSO index for 2003-2013 is different from the population mean.</p>
<p>In statistical hypothesis testing, we typically use a threshold probability for which we reject the null hypothesis. The threshold is often 5%, e.g. if there is less than a 5% chance that the sample mean and the population mean are the same, then we reject the null hypothesis and we say “the sample mean is <em>significantly</em> different from the population mean”</p>
<section id="hypothesis-testing-revisited">
<h2>Hypothesis Testing Revisited<a class="headerlink" href="#hypothesis-testing-revisited" title="Permalink to this headline">#</a></h2>
<section id="terminology">
<h3>Terminology<a class="headerlink" href="#terminology" title="Permalink to this headline">#</a></h3>
<p>Let’s formalize the steps we went through above to perform a <span class="math notranslate nohighlight">\(z\)</span>-test with some terminology:</p>
<ul class="simple">
<li><p><strong>significance/confidence level</strong>: the significance level, <span class="math notranslate nohighlight">\(\alpha\)</span>, is the threshold and is typically 5% (0.05). This is often reported as the confidence level, 1 - <span class="math notranslate nohighlight">\(\alpha\)</span>, e.g. “the 95% confidence level”.</p></li>
<li><p><strong>critical value</strong>: <span class="math notranslate nohighlight">\(z_c\)</span>, the value of <span class="math notranslate nohighlight">\(z\)</span> that must be exceeded to reject the null hypothesis. The value of <span class="math notranslate nohighlight">\(z_c\)</span> depends on the formulation of your alternative hypothesis, i.e. is a one-sided <span class="math notranslate nohighlight">\(z_{\alpha}\)</span>, two-sided <span class="math notranslate nohighlight">\(z_{\alpha/2}\)</span> test appropriate (more on this below).</p></li>
<li><p><strong>p-value</strong>: the probability of observing a signal given that the null hypothesis is true (probability of your <span class="math notranslate nohighlight">\(z\)</span>-statistic).</p></li>
</ul>
<figure class="align-default" id="onetwoside">
<a class="reference internal image-reference" href="../../_images/onetwoside.png"><img alt="../../_images/onetwoside.png" src="../../_images/onetwoside.png" style="width: 523.9px; height: 490.1px;" /></a>
<figcaption>
<p><span class="caption-text">The area under the curve for a (a) one-sided and (b) two-sided <span class="math notranslate nohighlight">\(z\)</span>-test.</span><a class="headerlink" href="#onetwoside" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#onetwoside"><span class="std std-ref">Figure 8</span></a> depicts the critical value, <span class="math notranslate nohighlight">\(z_c\)</span> and the significance level, <span class="math notranslate nohighlight">\(\alpha\)</span>, for a one-sided and two-sided <span class="math notranslate nohighlight">\(z\)</span>-test. In practice, you will almost always perform a two-sided test. This means that we are testing whether there is a signal but we do not know the sign of the signal, e.g. the alternative hypothesis is that the sample mean is different from the population mean, but we don’t know whether it’s greater than or less than the population mean. This is a more conservative test. In specific cases, a one-sided test may be appropriate (follow this <a class="reference external" href="https://stats.idre.ucla.edu/other/mult-pkg/faq/general/faq-what-are-the-differences-between-one-tailed-and-two-tailed-tests/">link</a> to learn more).</p>
</div>
</section>
<section id="five-simple-steps">
<h3>Five Simple Steps<a class="headerlink" href="#five-simple-steps" title="Permalink to this headline">#</a></h3>
<p>In using statistical significance tests, there are 5 simple steps that should be followed, <em>in order</em>.</p>
<ul class="simple">
<li><p>State the significance level (<span class="math notranslate nohighlight">\(\alpha\)</span>)</p></li>
<li><p>State the null hypothesis <span class="math notranslate nohighlight">\(H_0\)</span> and the alternative <span class="math notranslate nohighlight">\(H_1\)</span></p></li>
<li><p>State the statistic to be used<span class="math notranslate nohighlight">\(^*\)</span>, and the assumptions required to use it</p></li>
<li><p>State the critical region (one-sided or two-sided test)</p></li>
<li><p>Evaluate the statistic and state the conclusion</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(^*\)</span>for now we are just using the <span class="math notranslate nohighlight">\(z\)</span>-statistic.</p>
<p>Let’s go through an example following these 5 steps.</p>
<div class="tip admonition">
<p class="admonition-title">Question #3</p>
<p>Sam is a ski instructor and went skiing 60 times at Mont Tremblant this winter. The average temperature on these 60 days was -7°C, and the standard deviation of 60 daily temperatures is 6°C. Sam knows that the climatological mean winter temperature for Mont Tremblant is -10°C. Is this a sign of climate change?</p>
</div>
<p>Try to go through the steps on your own before you take a look at the answers.</p>
<div class="toggle docutils container">
<p>Step 1. let’s use the 95% significance level (<span class="math notranslate nohighlight">\(\alpha\)</span> = 0.05)</p>
</div>
<div class="toggle docutils container">
<p>Step 2. <span class="math notranslate nohighlight">\(H_0\)</span>: <span class="math notranslate nohighlight">\(\mu\)</span> = -10°C and <span class="math notranslate nohighlight">\(H_1\)</span>: <span class="math notranslate nohighlight">\(\mu\)</span> <span class="math notranslate nohighlight">\(\neq\)</span> -10°C</p>
</div>
<div class="toggle docutils container">
<p>Step 3. Since we have <span class="math notranslate nohighlight">\(N\)</span> = 60 samples to estimate the true standard deviation (<span class="math notranslate nohighlight">\(\sigma\)</span>) from the sample standard deviation (<span class="math notranslate nohighlight">\(s\)</span>), we can use a <span class="math notranslate nohighlight">\(z\)</span>-test (<span class="math notranslate nohighlight">\(N\)</span> is sufficiently large).</p>
</div>
<div class="toggle docutils container">
<p>Step 4. We will use a two-sided <span class="math notranslate nohighlight">\(z\)</span>-test (before he went skiing, Sam didn’t know what to expect from the temperatures). Thus, to reject the null hypothesis we must have <span class="math notranslate nohighlight">\(z\)</span> &gt; <span class="math notranslate nohighlight">\(z_{0.025}\)</span> = 1.96.</p>
</div>
<div class="toggle docutils container">
<p>Step 5. (see code below). Since <span class="math notranslate nohighlight">\(z\)</span> is greater than 1.96, we can reject the null hypothesis and accept the alternative hypothesis that the sample is significantly different from climatology for the days Sam went skiing. Further analysis needs to be done to <em>attribute</em> this to climate change.</p>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 5. Now, we compute the z-statistic</span>

<span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">6</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">60</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.8729833462074166
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="errors-in-hypothesis-testing">
<h3>Errors in Hypothesis Testing<a class="headerlink" href="#errors-in-hypothesis-testing" title="Permalink to this headline">#</a></h3>
<p>You may be familiar with the terms “false positive” and “false negative”, but you may not realize that these are statistical terms and are used to categorize possible errors in statistical tests.</p>
<p>For example, when you reject a null hypothesis, there is a chance that you are making a mistake. The null hypothesis might in fact be true, and it may be that your data deviate from the null hypothesis purely by chance. This is an example of a <em>false positive</em>. A <em>false positive</em> (also called a Type I error) occurs when the null hypothesis <span class="math notranslate nohighlight">\(H_0\)</span> is in fact true, but we reject it based on our data. A <em>false negative</em> (also called a Type II error) occurs when the null hypothesis <span class="math notranslate nohighlight">\(H_0\)</span> is in fact false, but we do not reject it based on our test.</p>
<p><a class="reference internal" href="#errors"><span class="std std-ref">Figure 9</span></a> illustrates the matrix of possible outcomes of statistical tests. Although it is not possible to know if, for example, your rejection of your null hypothesis is in error, it is important to keep this matrix in mind. This matrix also illustrates why we can never say that a statistical test “proves” our hypothesis; there’s always a small chance that our data are anomalous and differ from the null hypothesis purely by chance.</p>
<figure class="align-default" id="errors">
<a class="reference internal image-reference" href="../../_images/errors.png"><img alt="../../_images/errors.png" src="../../_images/errors.png" style="width: 544.0px; height: 308.0px;" /></a>
<figcaption>
<p><span class="caption-text">Matrix of possible outcomes of statistical tests. The rows indicate the outcome of the test and the columns indicate the truth.</span><a class="headerlink" href="#errors" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="confidence-intervals">
<h2>Confidence Intervals<a class="headerlink" href="#confidence-intervals" title="Permalink to this headline">#</a></h2>
<p>We can also use the <span class="math notranslate nohighlight">\(z\)</span>-statistic to determine confidence intervals on the true population mean, <span class="math notranslate nohighlight">\(\mu\)</span>. Here is an example:</p>
<div class="tip admonition">
<p class="admonition-title">Question #4</p>
<p>Say we have surface air temperatures for 30 winters with a mean of 10°C and a standard deviation of 5°C. What is the 95% confidence interval on the true population mean? You may assume that the temperatures are normally distributed.</p>
</div>
<p>In this question, we are told to estimate the 95% confidence intervals. This means we should consider the 95% confidence level, i.e. the 5% significance level.</p>
<p>To estimate the 95% confidence intervals on <span class="math notranslate nohighlight">\(\mu\)</span>, we can simply rearrange the equation for <span class="math notranslate nohighlight">\(z\)</span> as follows,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
z &amp;= \frac{\overline{x} - \mu}{\frac{\sigma}{\sqrt{N}}} \\
\mu &amp; = \overline{x} - z\frac{\sigma}{\sqrt{N}}
\end{align}
\end{split}\]</div>
<p>Since we are interested in the 95% confidence intervals centred on <span class="math notranslate nohighlight">\(\mu\)</span>, and since the normal distribution is symmetric about the <span class="math notranslate nohighlight">\(\mu\)</span>, this can be rewritten as,</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\mu &amp; = \overline{x} \pm z_{\alpha/2}\frac{\sigma}{\sqrt{N}}
\end{align}
\]</div>
<p>where <span class="math notranslate nohighlight">\(z_{\alpha/2}\)</span> is the value for <span class="math notranslate nohighlight">\(z\)</span> for a two-sided 95% confidence level (5% significance level). We can use python get find this value:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Question #4</span>
<span class="c1"># find z values for a two-sided 95% confidence level</span>
<span class="n">zneg</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.025</span><span class="p">)</span> <span class="c1"># negative side of distribution</span>
<span class="n">zpos</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">)</span> <span class="c1"># positive side of distribution</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zneg</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">zpos</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.96 1.96
</pre></div>
</div>
</div>
</div>
<p>Plugging this all in, we get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\mu &amp; = 10 \pm 1.96\frac{5}{\sqrt{30}}\\
&amp; = 10 \pm 1.7
\end{align}
\end{split}\]</div>
<p>Thus, the 95% confidence intervals on the true population mean, <span class="math notranslate nohighlight">\(\mu\)</span> are,</p>
<div class="math notranslate nohighlight">
\[
8.2^{\circ}C \leq \mu \leq 11.8^{\circ}C
\]</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "kls2177/Climate-and-Geophysical-Data-Analysis",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters/Week2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-testing-revisited">Hypothesis Testing Revisited</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#terminology">Terminology</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#five-simple-steps">Five Simple Steps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#errors-in-hypothesis-testing">Errors in Hypothesis Testing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals">Confidence Intervals</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Karen Smith
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>